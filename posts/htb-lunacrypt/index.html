<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="Hack The Box - LunaCrypt pwned!" /><meta property="og:locale" content="en" /><meta name="description" content="Description" /><meta property="og:description" content="Description" /><link rel="canonical" href="https://rubenhortas.github.io/posts/htb-lunacrypt/" /><meta property="og:url" content="https://rubenhortas.github.io/posts/htb-lunacrypt/" /><meta property="og:site_name" content="rubenhortas@blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-10-07T02:00:01+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Hack The Box - LunaCrypt pwned!" /><meta name="twitter:site" content="@rubenhortas" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-10-07T02:00:01+02:00","datePublished":"2022-10-07T02:00:01+02:00","description":"Description","headline":"Hack The Box - LunaCrypt pwned!","mainEntityOfPage":{"@type":"WebPage","@id":"https://rubenhortas.github.io/posts/htb-lunacrypt/"},"url":"https://rubenhortas.github.io/posts/htb-lunacrypt/"}</script><title>Hack The Box - LunaCrypt pwned! | rubenhortas@blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="rubenhortas@blog"><meta name="application-name" content="rubenhortas@blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">rubenhortas@blog</a></div><div class="site-subtitle font-italic">Learning everyday</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="javascript:location.href = 'mailto:' + ['rubenhortas','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/rubenhortas" aria-label="linkedin" target="_blank" rel="noopener noreferrer"> <i class="fab fa-linkedin"></i> </a> <a href="https://github.com/rubenhortas" aria-label="github" target="_blank" rel="noopener noreferrer"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/rubenhortas" aria-label="twitter" target="_blank" rel="noopener noreferrer"> <i class="fab fa-twitter"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Hack The Box - LunaCrypt pwned!</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Hack The Box - LunaCrypt pwned!</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1665100801" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Oct 7, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/rubenhortas">Rubén Hortas</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1925 words"> <em>10 min</em> read</span></div></div></div><div class="post-content"><h2 id="description"><span class="mr-2">Description</span><a href="#description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><blockquote><p>Our astronaut gained access to a key satellite and intercepted an encrypted message. The forensics team also recovered a file that looks like a custom encryption protocol. We’re sure that these two elements are linked. Please can you help us reveal the contents of the secret message?</p></blockquote><p>When we extract the LunaCrypt.zip file we found two files:</p><ul><li>LunaCrypt.py → The script used for the encryption<li>output.txt → The encrypted flag</ul><p>We have to look at the code to decrypt the message.</p><h2 id="analyzing-lunacryptpy"><span class="mr-2">Analyzing LunaCrypt.py</span><a href="#analyzing-lunacryptpy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="the-output"><span class="mr-2">The output</span><a href="#the-output" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>We take a look at the function that writes the ouput:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">output</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="nf">str</span><span class="p">(</span><span class="nf">ord</span><span class="p">(</span><span class="n">v</span><span class="p">))</span><span class="si">}</span><span class="s"> </span><span class="si">{</span><span class="nf">str</span><span class="p">(</span><span class="nf">ord</span><span class="p">(</span><span class="n">FLAGS</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span><span class="si">}</span><span class="sh">"</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">CHARS</span><span class="p">)]</span>
</pre></table></code></div></div><p>We can see that the output is written by pairs of numbers. The first number is an encrypted character (ct) and the second number is the flag used to encrypt it.</p><p>We take a look at the FLAG list generation:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">AppendFlag</span><span class="p">(</span><span class="n">flag</span><span class="p">):</span>
	<span class="n">FLAGS</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nf">strchr</span><span class="p">(</span><span class="nf">bitxor</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="mh">0x4A</span><span class="p">)))</span>
</pre></table></code></div></div><p>Here we can see that the flags written in the output are xored with the key 0x4A.<br /> We need to keep this in mind in order to get the flags used for the characters encryption.</p><h3 id="the-encryption"><span class="mr-2">The encryption</span><a href="#the-encryption" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>If we take a look to the function used to encrypt the characters:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">EncryptCharacter</span><span class="p">(</span><span class="n">char</span><span class="p">):</span>
	<span class="n">char</span> <span class="o">=</span> <span class="nc">ValidateChar</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
	<span class="n">flag</span> <span class="o">=</span> <span class="nc">GenerateFlag</span><span class="p">()</span>

	<span class="k">if</span> <span class="nc">CheckFlag</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">FL_SWAPBYTES</span><span class="p">):</span>
		<span class="n">char</span> <span class="o">=</span> <span class="nc">ESwapChar</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
	<span class="k">if</span> <span class="nc">CheckFlag</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">FL_NEGATE</span><span class="p">):</span>
		<span class="n">char</span> <span class="o">=</span> <span class="nc">NegateChar</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
	<span class="k">if</span> <span class="nc">CheckFlag</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">FL_XORBY6B</span><span class="p">):</span>
		<span class="n">char</span> <span class="o">=</span> <span class="nc">XorBy6B</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
	<span class="k">if</span> <span class="nc">CheckFlag</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">FL_XORBY3E</span><span class="p">):</span>
		<span class="n">char</span> <span class="o">=</span> <span class="nc">XorBy3E</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">char</span><span class="p">,</span> <span class="n">flag</span>
</pre></table></code></div></div><p>We can see that the first thing done is a character validation:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="n">strbyt</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">:</span> <span class="nf">ord</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">y</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">ValidateChar</span><span class="p">(</span><span class="n">char</span><span class="p">):</span>
	<span class="k">if</span> <span class="nf">type</span><span class="p">(</span><span class="n">char</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span> <span class="ow">and</span> <span class="nf">len</span><span class="p">(</span><span class="n">char</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
		<span class="n">char</span> <span class="o">=</span> <span class="nf">strbyt</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
	<span class="k">return</span> <span class="n">char</span>
</pre></table></code></div></div><p>The only thing that does the ValidateChar() function is return the ordinal of the character if the character has length 1, otherwise returns the character.</p><p>Then, the EncryptCharacter() function generates the flag. The flag generation is completely random and several flags may be activated at the same time.</p><p>Finally, the EncryptCharacter() function, checks if the flags FL_SWAPBYTES, FL_NEGATE, FL_XORBY6B and FL_XORBY3E are activated and, depending on which ones are activated, the encryption functions are applied to the character.</p><p>As several flags can be activated simultaneously, and the encrypting operations are applied in order, a character can undergo several encryptions. We need to keep this in mind in order to reverse this part.</p><h2 id="decrypting-the-message"><span class="mr-2">Decrypting the message</span><a href="#decrypting-the-message" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="reading-the-output"><span class="mr-2">Reading the output</span><a href="#reading-the-output" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>As the output is written by pairs of numbers, and the first number is the encrypted character, and the second number is the encrypted flag, we can read the output and separate the encrypted characters and the encrypted flags.</p><h3 id="decrypting-the-flags"><span class="mr-2">Decrypting the flags</span><a href="#decrypting-the-flags" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>As the flags are encrypted xoring the flag with the 0x4A key, by the properties of XOR, we can obtain the plaintext flags only by xoring the encrypted flags with the same key.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>pt ⊕ key = ct → ct ⊕ key = pt
</pre></table></code></div></div><h3 id="reversing-the-encryptcharacter-function"><span class="mr-2">Reversing the EncryptCharacter() function</span><a href="#reversing-the-encryptcharacter-function" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Since there can be several flags active at the same time, and the encryption functions are applied in order, the only thing we need to do is to reverse the order of the functions applied:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">DecryptCharacter</span><span class="p">(</span><span class="n">char</span><span class="p">,</span> <span class="n">flag</span><span class="p">):</span>
    <span class="n">char</span> <span class="o">=</span> <span class="nc">ValidateChar</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>

    <span class="k">if</span> <span class="nc">CheckFlag</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">FL_XORBY3E</span><span class="p">):</span>
        <span class="n">char</span> <span class="o">=</span> <span class="nc">XorBy3E</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
    <span class="k">if</span> <span class="nc">CheckFlag</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">FL_XORBY6B</span><span class="p">):</span>
        <span class="n">char</span> <span class="o">=</span> <span class="nc">XorBy6B</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
    <span class="k">if</span> <span class="nc">CheckFlag</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">FL_NEGATE</span><span class="p">):</span>
        <span class="n">char</span> <span class="o">=</span> <span class="nc">NegateChar</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
    <span class="k">if</span> <span class="nc">CheckFlag</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">FL_SWAPBYTES</span><span class="p">):</span>
        <span class="n">char</span> <span class="o">=</span> <span class="nc">InvertESwapChar</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>

    <span class="k">if</span> <span class="nf">type</span><span class="p">(</span><span class="n">char</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">char</span> <span class="o">=</span> <span class="nf">strchr</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">char</span>
</pre></table></code></div></div><h3 id="reversing-xorby3e-xorby6b-and-negatechar"><span class="mr-2">Reversing XorBy3E, XorBy6B and NegateChar</span><a href="#reversing-xorby3e-xorby6b-and-negatechar" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>As these functions are only xorings (remember the XOR properties: <code class="language-plaintext highlighter-rouge">pt ⊕ key = ct → ct ⊕ key = pt</code>) and a negation, the inverse of these functions are the same functions.</p><h3 id="reversing-eswapchar-function"><span class="mr-2">Reversing ESwapChar() function</span><a href="#reversing-eswapchar-function" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>This is the tricky part of the challenge. Once you understand what it does, reversing it is pretty straightforward (although I spent more time on it than I’d like to assume…).</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">ESwapChar</span><span class="p">(</span><span class="n">char</span><span class="p">):</span>
	<span class="n">char</span> <span class="o">=</span> <span class="nc">ValidateChar</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
	<span class="n">THIS_MSB</span> <span class="o">=</span> <span class="nf">bitext</span><span class="p">(</span><span class="n">char</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
	<span class="n">THIS_LSB</span> <span class="o">=</span> <span class="nf">bitext</span><span class="p">(</span><span class="n">char</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

	<span class="k">return</span> <span class="nf">strchr</span><span class="p">(</span><span class="nf">bitbor</span><span class="p">(</span><span class="nf">bitxor</span><span class="p">(</span><span class="n">THIS_MSB</span><span class="p">,</span> <span class="mh">0x0D</span><span class="p">),</span> <span class="nf">bitxor</span><span class="p">(</span><span class="nf">bitlst</span><span class="p">(</span><span class="n">THIS_LSB</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="mh">0xB0</span><span class="p">)))</span>
</pre></table></code></div></div><p>What does this function do?</p><p>The first thing this function does is validate the character (we’ve seen before that this returns the ordinal of the character if the character has length 1, otherwise returns the character).</p><p>Then declares two variables (in capital letters!? Really? ¬¬!): THIS_MSB and THIS_LSB</p><p>Lastly, this function applies some operations to THIS_MSB and THIS_LSB to get the encrypted char.</p><p>Let’s simplify the encrypt function a bit:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>* strchr = lambda x: chr(x)
* bitbor = lambda x, y: x | y → or
* bitxor = lambda x, y: x ^ y → xor
* bitlst = lambda x, y: x &lt;&lt; y → Left shift, moves x to the left y places

  return strchr(bitbor(bitxor(THIS_MSB, 0x0D), bitxor(bitlst(THIS_LSB, 4), 0xB0))) →
→   ct = strchr(bitbor(bitxor(THIS_MSB, 0x0D), bitxor(bitlst(THIS_LSB, 4), 0xB0))) →
→   ct = chr(OR[XOR(THIS_MSB, 0x0D), XOR(bitlst(THIS_LSB, 4), 0xB0)])
→   ct = chr[(THIS_MSB ⊕ 0x0D) | (bitlst(THIS_LSB, 4) ⊕ 0xB0)]
</pre></table></code></div></div><p>We can see that the operation is a chr() applied over an OR between two XORs, so we’ll need to start by reversing the two XORs.</p><h3 id="left-xor-xorthis_msb-0x0d"><span class="mr-2">Left XOR: XOR(THIS_MSB, 0x0D)</span><a href="#left-xor-xorthis_msb-0x0d" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Ok, as this part it’s a simpe XOR between THIS_MSB and 0x0D, what does THIS_MSB do?</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>* bitrst = lambda x, y: x &gt;&gt; y → Right shift, moves x to the right y places
* bitext = lambda x, y, z=1: bitrst(x, y) &amp; int(math.pow(2, z) - 1) =  # the value of z will be overriden by the value of the caller function 
         = (x &gt;&gt; y) &amp; int(math.pow(2, z) - 1)

* THIS_MSB = bitext(char, 4, 4) =
           = (char &gt;&gt; 4) &amp; int(math.pow(2, 4) - 1) =  # SWAP! (char &gt;&gt; 4) converts the 4 most significant bits of the plaintext (pt) char into the 4 least significant bits of the encrypted char (ct)
           = (char &gt;&gt; 4) &amp; int(16 - 1) =
           = (char &gt;&gt; 4) &amp; 15
</pre></table></code></div></div><p>Let’s see it in action:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>pt = char = 'A' = 0100 **0001**

    0000 **0100** char &gt;&gt; 4 → SWAP!
AND 0000   1111   15*
    -------------
    0000   0100   (char &gt;&gt;4) &amp; 15 = THIS_MSB
XOR 0000   1101   0x0D
    -------------
    0000   1001   THIS_MSB ⊕ 0x0D = left XOR
</pre></table></code></div></div><p><em>*As (0&amp;0) = 0 and (0&amp;1) = 1 and we are working only with the four least significant bits, this function does nothing and we can skip it to reverse this part</em></p><h3 id="right-xor-xorbitlstthis_lsb-4-0xb0"><span class="mr-2">Right XOR: XOR(bitlst(THIS_LSB, 4), 0xB0))</span><a href="#right-xor-xorbitlstthis_lsb-4-0xb0" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>This part it’s another simple XOR between bitlst(THIS_LSB, 4) and 0xB0. So, what does bitlst(THIS_LSB, 4) do?</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>* THIS_LSB = bitext(char, 0, 4)
* bitext = (x &gt;&gt; y) &amp; int(math.pow(2, z) - 1)  # the value of z will be overriden by the value of the caller function 

→ THIS_LSB = (char &gt;&gt; 0) &amp; int(math.pow(2, 4) - 1) =
           = char &amp; int(math.pow(2, 4) - 1) = 
           = char &amp; 15

* bitlst = lambda x, y: x &lt;&lt; y  # SWAP! Left shift, moves x to the left y places

bitlst(THIS_LSB, 4) = bitext(char, 0, 4) =
                    = THIS_LSB &lt;&lt; 4 =  #  SWAP! &lt;&lt; 4 converts the 4 least significant bits of the plaintext char (pt) into the 4 most significant bits of the encrypted char (ct)
                    = (char &amp; 15) &lt;&lt; 4 
</pre></table></code></div></div><p>Let’s see it in action:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>pt = char = 'A' = 0100 0001

    0100   0001   char
AND 0000   1111   15 *
    -------------
    0000 **0001** char &amp; 15 = THIS_LSB

    **0001** 0000 bitlst(THIS_LSB) = THIS_LSB &lt;&lt; 4  # SWAP!
XOR   1011   0000 0xB0
    -------------
      1010   0000 bitlst(THIS_LSB) ⊕ 0xB0 = right XOR
</pre></table></code></div></div><p><em>*As (0&amp;0) = 0 and (0&amp;1) = 1 and we are working only with the four least significant bits, this function does nothing and we can skip it to reverse this part</em></p><h4 id="ct--chrorxorthis_msb-0x0d-xorbitlstthis_lsb-4-0xb0"><span class="mr-2">ct = chr(OR[XOR(THIS_MSB, 0x0D), XOR(bitlst(THIS_LSB, 4), 0xB0)])</span><a href="#ct--chrorxorthis_msb-0x0d-xorbitlstthis_lsb-4-0xb0" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>ct = chr(OR[XOR(THIS_MSB, 0x0D), XOR(bitlst(THIS_LSB, 4), 0xB0)])
   = chr(OR[XOR(THIS_MSB, 0x0D), XOR(bitlst(THIS_LSB, 4), 0xB0)])
   = chr(OR(left XOR, right XOR)) 
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>   0000 1001 left XOR
OR 1010 0000 right XOR
   ---------
   1010 1001 ct = ©
</pre></table></code></div></div><h4 id="reversing-the-left-xor-xorthis_msb-0x0d"><span class="mr-2">Reversing the Left XOR: XOR(THIS_MSB, 0x0D)</span><a href="#reversing-the-left-xor-xorthis_msb-0x0d" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>We part from ct = 1010 1001, and we know that the Left XOR give rise to the four least significant bits of the encrypted character (ct), so, first, we will clear the four most significant bits of the ct:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>0000 1001 ct masked  # Four most significant bits cleared
</pre></table></code></div></div><p>Now, we need to reverse the XOR with 0x0D, in order to do this (and by the properties of XOR: <code class="language-plaintext highlighter-rouge">pt ⊕ key = ct → ct ⊕ key = pt</code>) we only need to XOR it with 0x0D again:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>    0000 1001 ct masked
XOR 0000 1101 0x0D
    ---------
    0000 0100 pt upper bits without swapping
</pre></table></code></div></div><p>Finally, we need to reverse the swapping to make the four least significant bits of the ct becomes again the four most significant bits of the pt:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>0100 0000 pt upper bits without swapping &lt;&lt; 4 = pt upper bits
</pre></table></code></div></div><h4 id="reversing-the-right-xor-xorbitlstthis_lsb-4-0xb0"><span class="mr-2">Reversing the Right XOR: XOR(bitlst(THIS_LSB, 4), 0xB0))</span><a href="#reversing-the-right-xor-xorbitlstthis_lsb-4-0xb0" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>We part from ct = 1010 1001, and we know that the Right XOR give rise to the four most significant bits of the encrypted character (ct), so, first, we will clear the four least significant bits of the ct:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>1010 0000 ct masked (four least significant bits cleared)
</pre></table></code></div></div><p>Now, we need to reverse the XOR with 0xB0, in order to do this (and by the properties of XOR: <code class="language-plaintext highlighter-rouge">pt ⊕ key = ct → ct ⊕ key = pt</code>) we only need to XOR it with 0xB0 again:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>    1010 0000 ct masked
XOR 1011 0000 0xB0
    ---------
    0001 0000 pt lower bits without swapping  # = bitlst(THIS_LSB, 4) = THIS_LSB &lt;&lt; 4
</pre></table></code></div></div><p>Finally, we need to reverse the swapping to make the four most significant bits of the ct becomes again the four least significant bits of the pt:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>0000 0001 pt lower bits without swapping &gt;&gt; 4 = pt lower bits
</pre></table></code></div></div><h4 id="reversing-the-or-getting-the-pt-chrorxorthis_msb-0x0d-xorbitlstthis_lsb-4-0xb0"><span class="mr-2">Reversing the OR (getting the pt): chr(OR[XOR(THIS_MSB, 0x0D), XOR(bitlst(THIS_LSB, 4), 0xB0)])</span><a href="#reversing-the-or-getting-the-pt-chrorxorthis_msb-0x0d-xorbitlstthis_lsb-4-0xb0" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>To reverse the OR we only need to apply the OR again:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>   0100 0000 pt upper bits
OR 0000 0001 pt lower bits
   ---------
   0100 0001 = pt = 'A'
</pre></table></code></div></div><p>And… We have our pt!</p><h4 id="the-full-inverteswapchar-function"><span class="mr-2">The full InvertESwapChar() function:</span><a href="#the-full-inverteswapchar-function" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">InvertESwapChar</span><span class="p">(</span><span class="n">ct</span><span class="p">):</span>
    <span class="c1"># Left side -&gt; Revert (THIS_MSB xor 0x0D)
</span>    <span class="n">pt_upper</span> <span class="o">=</span> <span class="nc">ValidateChar</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>

    <span class="c1"># Convert 4 upper bits to 0 (Masking pt_upper)
</span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">):</span>
        <span class="n">pt_upper</span> <span class="o">=</span> <span class="n">pt_upper</span> <span class="o">&amp;</span> <span class="o">~</span><span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">)</span>

    <span class="n">pt_upper</span> <span class="o">=</span> <span class="n">pt_upper</span> <span class="o">^</span> <span class="mh">0x0D</span>
    <span class="n">pt_upper</span> <span class="o">=</span> <span class="n">pt_upper</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span>

    <span class="c1"># Right side -&gt; Revert (bitlst(THIS_LSB, 4) xor 0xB0)
</span>    <span class="n">pt_lower</span> <span class="o">=</span> <span class="nc">ValidateChar</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>

    <span class="c1"># Convert 4 lower bits to 0 (Masking pt_lower)
</span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">pt_lower</span> <span class="o">=</span> <span class="n">pt_lower</span> <span class="o">&amp;</span> <span class="o">~</span><span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">)</span>

    <span class="n">pt_lower</span> <span class="o">=</span> <span class="n">pt_lower</span> <span class="o">^</span> <span class="mh">0xB0</span>  <span class="c1"># = bitlst
</span>    <span class="n">pt_lower</span> <span class="o">=</span> <span class="n">pt_lower</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span>  <span class="c1"># bitlst &gt;&gt; 4
</span>
    <span class="n">pt</span> <span class="o">=</span> <span class="n">pt_upper</span> <span class="o">|</span> <span class="n">pt_lower</span>

    <span class="k">return</span> <span class="nf">chr</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span>
</pre></table></code></div></div><p>To solve this challenge, I did a python script that you can see at: <a href="https://github.com/rubenhortas/hackthebox/blob/main/lunaCrypt/luna_decrypt.py">luna_decrypt.py</a></p><p><a href="/assets/img/posts/owned-lunacrypt.png" class="popup img-link shadow shimmer"><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 600'%3E%3C/svg%3E" data-src="/assets/img/posts/owned-lunacrypt.png" alt="Challenge results" width="700" height="600" class="lazyload" data-proofer-ignore></a> <em>LunaCrypt has been Pwned</em></p><p><em>Enjoy! ;)</em></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hack-the-box/'>hack the box</a>, <a href='/categories/challenge/'>challenge</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/hack-the-box/" class="post-tag no-text-decoration" >hack the box</a> <a href="/tags/challenge/" class="post-tag no-text-decoration" >challenge</a> <a href="/tags/crypto/" class="post-tag no-text-decoration" >crypto</a> <a href="/tags/htb/" class="post-tag no-text-decoration" >htb</a> <a href="/tags/lunacrypt/" class="post-tag no-text-decoration" >LunaCrypt</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hack%20The%20Box%20-%20LunaCrypt%20pwned!%20-%20rubenhortas@blog&url=https%3A%2F%2Frubenhortas.github.io%2Fposts%2Fhtb-lunacrypt%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hack%20The%20Box%20-%20LunaCrypt%20pwned!%20-%20rubenhortas@blog&u=https%3A%2F%2Frubenhortas.github.io%2Fposts%2Fhtb-lunacrypt%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Frubenhortas.github.io%2Fposts%2Fhtb-lunacrypt%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/neovim-python-ide/">Configuring Neovim as Python IDE</a><li><a href="/posts/neovim-rust-ide/">Configuring Neovim as Rust IDE</a><li><a href="/posts/neovim-c-standard-ide/">Configuring Neovim as Standard C IDE</a><li><a href="/posts/pycharm-neovim-ruff-consistency/">Unify Python Linting. Syncing Ruff between PyCharm and Neovim</a><li><a href="/posts/check-ntp-servers-windows/">How to check NTP servers from Windows</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hack-the-box/">hack the box</a> <a class="post-tag" href="/tags/challenge/">challenge</a> <a class="post-tag" href="/tags/gnu-linux/">gnu/linux</a> <a class="post-tag" href="/tags/administration/">administration</a> <a class="post-tag" href="/tags/personal/">personal</a> <a class="post-tag" href="/tags/hardening/">hardening</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/programming/">programming</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/ssh/">ssh</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div><script src="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.js"></script></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/htb-lost-modulus/"><div class="card-body"> <em class="small" data-ts="1661385601" data-df="ll" > Aug 25, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack the box Lost Modulus pwned!</h3><div class="text-muted small"><p> Challenge description I encrypted a secret message with RSA but I lost the modulus. Can you help me recover it? Solution When we extract the Lost Modulus.zip file we found two files: chal...</p></div></div></a></div><div class="card"> <a href="/posts/htb-deterministic/"><div class="card-body"> <em class="small" data-ts="1651363201" data-df="ll" > May 1, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack the box Deterministic</h3><div class="text-muted small"><p> Challenge description There is a locked door in front of us that can only be opened with the secret passphrase. There are no keys anywhere in the room, only this .txt. There is also a writing ...</p></div></div></a></div><div class="card"> <a href="/posts/htb-misdirection/"><div class="card-body"> <em class="small" data-ts="1651708801" data-df="ll" > May 5, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - misDIRection pwned!</h3><div class="text-muted small"><p> Description During an assessment of a unix system the HTB team found a suspicious directory. They looked at everything within but couldn’t find any files with malicious intent. Solution When...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/htb-baby-time-capsule/" class="btn btn-outline-primary" prompt="Older"><p>Hack The Box - Baby Time Capsule pwned!</p></a> <a href="/posts/htb-exploitedstream/" class="btn btn-outline-primary" prompt="Newer"><p>Hack The Box - ExploitedStream pwned!</p></a></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hack-the-box/">hack the box</a> <a class="post-tag" href="/tags/challenge/">challenge</a> <a class="post-tag" href="/tags/gnu-linux/">gnu/linux</a> <a class="post-tag" href="/tags/administration/">administration</a> <a class="post-tag" href="/tags/personal/">personal</a> <a class="post-tag" href="/tags/hardening/">hardening</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/programming/">programming</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/ssh/">ssh</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2026 <a href="https://github.com/rubenhortas">Rubén Hortas</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/unregister.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-NJBDP43045"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-NJBDP43045'); }); </script>
