<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="Overthewire krypton level 6 LFSR" /><meta property="og:locale" content="en" /><meta name="description" content="Some time ago I started to solve the Krypton game from OverTheWire." /><meta property="og:description" content="Some time ago I started to solve the Krypton game from OverTheWire." /><link rel="canonical" href="https://rubenhortas.github.io/posts/overthewire-krypton-level-6-lfsr/" /><meta property="og:url" content="https://rubenhortas.github.io/posts/overthewire-krypton-level-6-lfsr/" /><meta property="og:site_name" content="rubenhortas@blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-03-03T01:00:01+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Overthewire krypton level 6 LFSR" /><meta name="twitter:site" content="@rubenhortas" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-03-17T14:29:46+01:00","datePublished":"2023-03-03T01:00:01+01:00","description":"Some time ago I started to solve the Krypton game from OverTheWire.","headline":"Overthewire krypton level 6 LFSR","mainEntityOfPage":{"@type":"WebPage","@id":"https://rubenhortas.github.io/posts/overthewire-krypton-level-6-lfsr/"},"url":"https://rubenhortas.github.io/posts/overthewire-krypton-level-6-lfsr/"}</script><title>Overthewire krypton level 6 LFSR | rubenhortas@blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="rubenhortas@blog"><meta name="application-name" content="rubenhortas@blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">rubenhortas@blog</a></div><div class="site-subtitle font-italic">Learning everyday</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="javascript:location.href = 'mailto:' + ['rubenhortas','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/rubenhortas" aria-label="linkedin" target="_blank" rel="noopener noreferrer"> <i class="fab fa-linkedin"></i> </a> <a href="https://github.com/rubenhortas" aria-label="github" target="_blank" rel="noopener noreferrer"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/rubenhortas" aria-label="twitter" target="_blank" rel="noopener noreferrer"> <i class="fab fa-twitter"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Overthewire krypton level 6 LFSR</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Overthewire krypton level 6 LFSR</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1677801601" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Mar 3, 2023 </em> </span> <span> Updated <em class="" data-ts="1679059786" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Mar 17, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/rubenhortas">Rubén Hortas</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2299 words"> <em>12 min</em> read</span></div></div></div><div class="post-content"><p>Some time ago I started to solve the <a href="https://overthewire.org/wargames/krypton/">Krypton</a> game from <a href="https://overthewire.org/wargames/">OverTheWire</a>.</p><p>I did a <a href="https://rubenhortas.github.io/posts/overthewire-krytpon-levels-4-and-5-vigenere-cipher/">walkthrough about Kripton Level 4 and Krypton Level 5</a>.</p><p>At this point, the only level that I had to solve was the <a href="https://overthewire.org/wargames/krypton/krypton6.html">Krypton Level 6</a>. This level consists in break a <a href="https://en.wikipedia.org/wiki/Stream_cipher">stream cipher</a>. And, as the statement warns, “<em>The challenge here is not simple</em>”.</p><h1 id="level-info">Level Info</h1><blockquote><p>Hopefully by now its obvious that encryption using repeating keys is a bad idea. Frequency analysis can destroy repeating/fixed key substitution crypto.</p><p>A feature of good crypto is random ciphertext. A good cipher must not reveal any clues about the plaintext. Since natural language plaintext (in this case, English) contains patterns, it is left up to the encryption key or the encryption algorithm to add the ‘randomness’.</p><p>Modern ciphers are similar to older plain substitution ciphers, but improve the ‘random’ nature of the key.</p><p>An example of an older cipher using a complex, random, large key is a vigniere using a key of the same size of the plaintext. For example, imagine you and your confident have agreed on a key using the book ‘A Tale of Two Cities’ as your key, in 256 byte blocks.</p><p>The cipher works as such:</p><p>Each plaintext message is broken into 256 byte blocks. For each block of plaintext, a corresponding 256 byte block from the book is used as the key, starting from the first chapter, and progressing. No part of the book is ever re-used as key. The use of a key of the same length as the plaintext, and only using it once is called a “One Time Pad”.</p><p>Look in the krypton6 directory. You will find a file called ‘plain1’, a 256 byte block. You will also see a file ‘key1’, the first 256 bytes of ‘A Tale of Two Cities’. The file ‘cipher1’ is the cipher text of plain1. As you can see (and try) it is very difficult to break the cipher without the key knowledge.</p><p>If the encryption is truly random letters, and only used once, then it is impossible to break. A truly random “One Time Pad” key cannot be broken. Consider intercepting a ciphertext message of 1000 bytes. One could brute force for the key, but due to the random key nature, you would produce every single valid 1000 letter plaintext as well. Who is to know which is the real plaintext?!?</p><p>Choosing keys that are the same size as the plaintext is impractical. Therefore, other methods must be used to obscure ciphertext against frequency analysis in a simple substitution cipher. The impracticality of an ‘infinite’ key means that the randomness, or entropy, of the encryption is introduced via the method.</p><p>We have seen the method of ‘substitution’. Even in modern crypto, substitution is a valid technique. Another technique is ‘transposition’, or swapping of bytes.</p><p>Modern ciphers break into two types; <strong>symmetric and asymmetric</strong>.</p><p><strong>Symmetric ciphers come in two flavours: block and stream</strong>.</p><p>Until now, we have been playing with classical ciphers, approximating ‘block’ ciphers. A block cipher is done in fixed size blocks (suprise!). For example, in the previous paragraphs we discussed breaking text and keys into 256 byte blocks, and working on those blocks. Block ciphers use a fixed key to perform substituion and transposition ciphers on each block discretely.</p><p><strong>Its time to employ a stream cipher</strong>. A stream cipher attempts to create an on-the-fly <strong>‘random’ keystream to encrypt the incoming plaintext one byte at a time</strong>. Typically, <strong>the ‘random’ key byte is xor’d with the plaintext to produce the ciphertext</strong>. <strong>If the random keystream can be replicated at the recieving end, then a further xor will produce the plaintext once again</strong>.</p><p>From this example forward, <strong>we will be working with bytes</strong>, not ASCII text, so a hex editor/dumper like hexdump is a necessity. Now is the right time to start to learn to use tools like cryptool.</p><p>In this example, the keyfile is in your directory, however it is not readable by you. The binary ‘encrypt6’ is also available. It will read the keyfile and <strong>encrypt any message you desire, using the key AND a ‘random’ number</strong>. You get to <strong>perform a ‘known ciphertext’ attack</strong> by introducing plaintext of your choice. The challenge here is not simple, but <strong>the ‘random’ number generator is weak</strong>.</p><p>As stated, it is now that we suggest you begin to use public tools, like cryptool, to help in your analysis. You will most likely need a hint to get going. See ‘HINT1’ if you need a kicktstart.</p><p>If you have further difficulty, there is a hint in ‘HINT2’.</p><p>The password for level 7 (krypton7) is encrypted with ‘encrypt6’.</p><p>Good Luck!</p></blockquote><h1 id="what-do-we-know-so-far-about-this-level">What do we know so far about this level?</h1><ul><li>It’s a symmetric cipher<li>It’s a stream cipher where the “random” key byte (k) is xor’d with the plain text (pt) to produce the ciphertext (ct):<br /> <code class="language-plaintext highlighter-rouge">k ⊕ pt = ct</code><li>k is a <strong>“<em>random</em>“</strong> keystream.<li>If the random keystream (k) can be replicated at the recieving end, then a further xor will produce the plaintext once again:<br /> <code class="language-plaintext highlighter-rouge">k ⊕ pt = ct → pt ⊕ ct = k</code><li>We will working with bytes.<li><code class="language-plaintext highlighter-rouge">encrypt6</code> will read the keyfile and encrypt any message using the <strong>key</strong> <strong><em>AND</em></strong> a <strong>“<em>random</em>“</strong> number.<li>We have to perfom a <a href="https://en.wikipedia.org/wiki/Ciphertext-only_attack">known ciphertext attack</a><li>The random number generator is weak.<li>The password for Krypton Level 7 is encrypted with <code class="language-plaintext highlighter-rouge">encrypt6</code>.</ul><h1 id="what-can-we-learn-from-the-clues">What can we learn from the clues?</h1><h2 id="hint1"><span class="mr-2">HINT1</span><a href="#hint1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><blockquote><p>The ‘random’ generator has a limited number of bits, and is periodic. Entropy analysis and a good look at the bytes in a hex editor will help.</p></blockquote><p>There is a pattern!</p><h2 id="hint2"><span class="mr-2">HINT2</span><a href="#hint2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><blockquote><p>8 bit LFSR</p></blockquote><h3 id="lfsr"><span class="mr-2"><a href="https://en.wikipedia.org/wiki/Linear-feedback_shift_register">LFSR</a></span><a href="#lfsr" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="https://en.wikipedia.org/wiki/Linear-feedback_shift_register">LFSR</a> is used as a pseudo-random number generator for use in stream ciphers, but, as the register has a fine number of pssible states <strong>it must eventually enter a repeating cycle</strong>. This means that <strong>the numbers generated are periodic</strong>.</p><ul><li>A maximum-length <a href="https://en.wikipedia.org/wiki/Linear-feedback_shift_register">LFSR</a> will produce an m-secuence, so <strong>a 8 bit <a href="https://en.wikipedia.org/wiki/Linear-feedback_shift_register">LFSR</a> will produce a 8 bit sequence</strong>.<li><strong>The most commonly used linear function of single bits is exclusive-or (XOR ⊕)</strong>.</ul><blockquote><p>Thus, an <a href="https://en.wikipedia.org/wiki/Linear-feedback_shift_register">LFSR</a> is most often a shift register whose input bit is driven by the XOR of some bits of the overall shift register value.</p></blockquote><blockquote><p>Given a stretch of known plaintext and corresponding ciphertext, an attacker can intercept and recover a stretch of LFSR output stream used in the system described, and from that stretch of the output stream can construct an LFSR of minimal size that simulates the intended receiver by using the Berlekamp-Massey algorithm. This LFSR can then be fed the intercepted stretch of output stream to recover the remaining plaintext.</p></blockquote><p><a href="https://en.wikipedia.org/wiki/Linear-feedback_shift_register">LFSR</a> works by feeding on their own output. They are constructed in a way that makes them endlessly cycle through a pattern of values while outputting that seemingly random pattern.</p><p>There’s a very graphic and good explanation about how a <a href="https://en.wikipedia.org/wiki/Linear-feedback_shift_register">LFSR</a> works in <a href="https://www.youtube.com/watch?v=Ks1pw1X22y4">Random Numbers with LFSR (Linear Feedback Shift Register) - Computerphile</a>.</p><h1 id="the-journey-to-solution">The journey to solution</h1><h2 id="fail-1"><span class="mr-2">Fail 1</span><a href="#fail-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>From the properties of XOR we know that:</p><p><code class="language-plaintext highlighter-rouge">plaintext ⊕ key = ciphertext → ciphertext ⊕ key = plaintext</code></p><p>And we know that:</p><p><code class="language-plaintext highlighter-rouge">p ⊕ 0 = p</code></p><p>Because:</p><div class="table-wrapper"><table><thead><tr><th>p<th>0<th>p⊕0<tbody><tr><td>0<td>0<td>0<tr><td>1<td>0<td>1</table></div><p>So, If we put a bunch of zeros as input, we’ll get the key directly:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>plaintext ⊕ key = ciphertext →
        0 ⊕ key = ciphertext →
        0 ⊕ key = key        → key = ciphertext
</pre></table></code></div></div><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>krypton6@bandit:/tmp/rubenhortas<span class="nv">$ </span><span class="nb">ln</span> <span class="nt">-s</span> /krypton/krypton6/keyfile.dat 
krypton6@bandit:/tmp/rubenhortas<span class="nv">$ </span>python3 <span class="nt">-c</span> <span class="s2">"print('0'*50)"</span> <span class="o">&gt;</span> zeros_pt.txt
krypton6@bandit:/tmp/rubenhortas<span class="nv">$ </span>/krypton/krypton6/encrypt6 zeros_pt.txt zeros_ct.txt
</pre></table></code></div></div><p>And our key is… An empty file! <strong>FAIL 1!</strong></p><h2 id="fail-2"><span class="mr-2">Fail 2</span><a href="#fail-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Ok, <code class="language-plaintext highlighter-rouge">encrypt6</code> doesn’t seem to work with numbers, so let’s try with letters…</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>krypton6@bandit:/tmp/rubenhortas<span class="nv">$ </span>python3 <span class="nt">-c</span> <span class="s2">"print('A'*50)"</span> <span class="o">&gt;</span> as_pt.txt
krypton6@bandit:/tmp/rubenhortas<span class="nv">$ </span>/krypton/krypton6/encrypt6 as_pt.txt as_ct.txt
krypton6@bandit:/tmp/rubenhortas<span class="nv">$ </span><span class="nb">cat </span>as_pt.txt 
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
krypton6@bandit:/tmp/rubenhortas<span class="nv">$ </span><span class="nb">cat </span>as_ct.txt 
EICTDGYIYZKTHNSIRFXYCPFUEOCKRNEICTDGYIYZKTHNSIRFXY
</pre></table></code></div></div><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>krypton6@bandit:/tmp/rubenhortas<span class="nv">$ </span>python3 <span class="nt">-c</span> <span class="s2">"print('B'*50)"</span> <span class="o">&gt;</span> bs_pt.txt
krypton6@bandit:/tmp/rubenhortas<span class="nv">$ </span>/krypton/krypton6/encrypt6 bs_pt.txt bs_ct.txt
krypton6@bandit:/tmp/rubenhortas<span class="nv">$ </span><span class="nb">cat </span>bs_pt.txt 
BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB
krypton6@bandit:/tmp/rubenhortas<span class="nv">$ </span><span class="nb">cat </span>bs_ct.txt 
FJDUEHZJZALUIOTJSGYZDQGVFPDLSOFJDUEHZJZALUIOTJSGYZ
</pre></table></code></div></div><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>krypton6@bandit:/tmp/rubenhortas<span class="nv">$ </span>python3 <span class="nt">-c</span> <span class="s2">"print('C'*50)"</span> <span class="o">&gt;</span> cs_pt.txt
krypton6@bandit:/tmp/rubenhortas<span class="nv">$ </span>/krypton/krypton6/encrypt6 cs_pt.txt cs_ct.txt
krypton6@bandit:/tmp/rubenhortas<span class="nv">$ </span><span class="nb">cat </span>cs_pt.txt 
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
krypton6@bandit:/tmp/rubenhortas<span class="nv">$ </span><span class="nb">cat </span>cs_ct.txt 
GKEVFIAKABMVJPUKTHZAERHWGQEMTPGKEVFIAKABMVJPUKTHZA
</pre></table></code></div></div><p>We can see some curious things:</p><ul><li>If we encrypt the same input (or plaintext) many times we’ll see the same output (or ciphertext) → We can forget about the random part for the key<li><p>The ciphertext will be repeated from the 30th character → The key will have a max length of 30 characters<br /> For example, the <code class="language-plaintext highlighter-rouge">as_ct.txt</code>:<br /> <strong>EICTDGYIYZKTHNSIRFXYCPFUEOCKRN</strong>EICTDGYIYZKTHNSIRFXY →<br /> → EICTDGYIYZKTHNSIRFXYCPFUEOCKRN<br /> → EICTDGYIYZKTHNSIRFXY</p><p>So, we can short our plaintexts and ciphertexts to 30, to make our work easier:</p><div class="table-wrapper"><table><thead><tr><th>Plaintext<th>Ciphertext<tbody><tr><td>AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA<td>EICTDGYIYZKTHNSIRFXYCPFUEOCKRN<tr><td>BBBBBBBBBBBBBBBBBBBBBBBBBBBBBB<td>FJDUEHZJZALUIOTJSGYZDQGVFPDLSO<tr><td>CCCCCCCCCCCCCCCCCCCCCCCCCCCCCC<td>GKEVFIAKABMVJPUKTHZAERHWGQEMTP</table></div><p>At this point I think the LFSR isn’t well tapped and it’s not giving a maximum cycle and period.</p><li>The ciphertext has the same length than the plaintext → Our ciphertext has 15 characters, so we need, at least, a 15 characters key.</ul><p>The first thing is to get the keys for our three ciphers and compare if they are the same. We’ll get the keys xoring the plaintext with the ciphertext, because:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>plaintext ⊕ key <span class="o">=</span> ciphertext → key <span class="o">=</span> plaintext ⊕ ciphertext
</pre></table></code></div></div><p>The keys:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>as_key: b<span class="s1">'\x04\x08\x02\x15\x05\x06\x18\x08\x18\x1b\n\x15\t\x0f\x12\x08\x13\x07\x19\x18\x02\x11\x07\x14\x04\x0e\x02\n\x13\x0f'</span>
bs_key: b<span class="s1">'\x04\x08\x06\x17\x07\n\x18\x08\x18\x03\x0e\x17\x0b\r\x16\x08\x11\x05\x1b\x18\x06\x13\x05\x14\x04\x12\x06\x0e\x11\r'</span>
cs_key: b<span class="s1">'\x04\x08\x06\x15\x05\n\x02\x08\x02\x01\x0e\x15\t\x13\x16\x08\x17\x0b\x19\x02\x06\x11\x0b\x14\x04\x12\x06\x0e\x17\x13'</span>
</pre></table></code></div></div><p>Ok, the keys are different… <strong>FAIL 2!</strong></p><h1 id="solution">Solution</h1><p>So now, we know that the function is deterministic, it always will give the same output (or ciphertext) for a given input (or plaintext), and the key will depend on the input (or the plaintext).</p><p>If we take a closer look to the plaintexts and the ciphertexts we can see that when we increment by one character our input (or plaintext), the output (or ciphertext) will also be increased by one character.</p><div class="table-wrapper"><table><thead><tr><th>Plaintext<th>Ciphertext<tbody><tr><td>AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA<td>EICTDGYIYZKTHNSIRFXYCPFUEOCKRN<tr><td>BBBBBBBBBBBBBBBBBBBBBBBBBBBBBB<td>FJDUEHZJZALUIOTJSGYZDQGVFPDLSO<tr><td>CCCCCCCCCCCCCCCCCCCCCCCCCCCCCC<td>GKEVFIAKABMVJPUKTHZAERHWGQEMTP</table></div><p>So, we can asume that the difference between the plaintext and the ciphertext will be constant.</p><p>I think, at this point we can solve this challenge with <a href="https://en.wikipedia.org/wiki/Linear_cryptanalysis">linear cryptanalysis</a>, <a href="https://en.wikipedia.org/wiki/Differential_cryptanalysis">differential cryptanalisys</a> or <a href="https://en.wikipedia.org/wiki/Berlekamp%E2%80%93Massey_algorithm">Berlekamp–Massey algorithm</a>… I don’t know for sure. I was researching (and reading algebraic theories beyond my means) when I did another test that gave me a clue to find a easier solution:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>krypton6@bandit:/tmp/rubenhortas<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"ABC"</span> <span class="o">&gt;</span> abc_pt.txt
krypton6@bandit:/tmp/rubenhortas<span class="nv">$ </span>/krypton/krypton6/encrypt6 abc_pt.txt abc_ct.txt
krypton6@bandit:/tmp/rubenhortas<span class="nv">$ </span><span class="nb">cat </span>abc_pt.txt 
ABC
krypton6@bandit:/tmp/rubenhortas<span class="nv">$ </span><span class="nb">cat </span>abc_ct.txt 
EJE
</pre></table></code></div></div><p>We can see that when encrypting a plaintext character in a certain position, it always give the same exact encrypted character in the same exact position…</p><div class="table-wrapper"><table><thead><tr><th>Plaintext<th>Ciphertext<tbody><tr><td>A<td><code class="language-plaintext highlighter-rouge">E</code><tr><td>B<td>F<code class="language-plaintext highlighter-rouge">J</code><tr><td>CCC<td>GK<code class="language-plaintext highlighter-rouge">E</code><tr><td>ABC<td><code class="language-plaintext highlighter-rouge">EJE</code></table></div><p>So I did a 26x30 matrix encrypting every english alphabet character 30 times (the length of the <a href="https://en.wikipedia.org/wiki/Linear-feedback_shift_register">LFSR</a> period). And the plaintext password for the Krypton Level 7 will be the result of find the plaintext character corresponding to the encrypted character in the corresponding position in our matrix:</p><div class="table-wrapper"><table><thead><tr><th> <th>P<th>N<th>U<th>K<th>L<th>Y<th>L<th>W<th>R<th>Q<th>K<th>G<th>K<th>B<th>E<th>…<tbody><tr><td><code class="language-plaintext highlighter-rouge">A</code><td>E<td>I<td>C<td>T<td>D<td>G<td>Y<td>I<td>Y<td>Z<td><code class="language-plaintext highlighter-rouge">K</code><td>T<td>H<td>N<td>S<td>IRFXYCPFUEOCKRN<tr><td>B<td>F<td>J<td>D<td>U<td>E<td>H<td>Z<td>J<td>Z<td>A<td>L<td>U<td>I<td>O<td>T<td>JSGYZDQGVFPDLSO<tr><td>C<td>G<td>K<td>E<td>V<td>F<td>I<td>A<td>K<td>A<td>B<td>M<td>V<td>J<td>P<td>U<td>KTHZAERHWGQEMTP<tr><td><code class="language-plaintext highlighter-rouge">D</code><td>H<td>L<td>F<td>W<td>G<td>J<td>B<td>L<td>B<td>C<td>N<td>W<td><code class="language-plaintext highlighter-rouge">K</code><td>Q<td>V<td>LUIABFSIXHRFNUQ<tr><td>E<td>I<td>M<td>G<td>X<td>H<td>K<td>C<td>M<td>C<td>D<td>O<td>X<td>L<td>R<td>W<td>MVJBCGTJYISGOVR<tr><td><code class="language-plaintext highlighter-rouge">F</code><td>J<td><code class="language-plaintext highlighter-rouge">N</code><td>H<td>Y<td>I<td>L<td>D<td>N<td>D<td>E<td>P<td>Y<td>M<td>S<td>X<td>NWKCDHUKZJTHPWS<tr><td>G<td>K<td>O<td>I<td>Z<td>J<td>M<td>E<td>O<td>E<td>F<td>Q<td>Z<td>N<td>T<td>Y<td>OXLDEIVLAKUIQXT<tr><td>H<td>L<td>P<td>J<td>A<td>K<td>N<td>F<td>P<td>F<td>G<td>R<td>A<td>O<td>U<td>Z<td>PYMEFJWMBLVJRYU<tr><td><code class="language-plaintext highlighter-rouge">I</code><td>M<td>Q<td>K<td>B<td><code class="language-plaintext highlighter-rouge">L</code><td>O<td>G<td>Q<td>G<td>H<td>S<td>B<td>P<td>V<td>A<td>QZNFGKXNCMWKSZV<tr><td>J<td>N<td>R<td>L<td>C<td>M<td>P<td>H<td>R<td>H<td>I<td>T<td>C<td>Q<td>W<td>B<td>RAOGHLYODNXLTAW<tr><td>K<td>O<td>S<td>M<td>D<td>N<td>Q<td>I<td>S<td>I<td>J<td>U<td>D<td>R<td>X<td>C<td>SBPHIMZPEOYMUBX<tr><td><code class="language-plaintext highlighter-rouge">L</code><td><code class="language-plaintext highlighter-rouge">P</code><td>T<td>N<td>E<td>O<td>R<td>J<td>T<td>J<td>K<td>V<td>E<td>S<td>Y<td>D<td>TCQIJNAQFPZNVCY<tr><td><code class="language-plaintext highlighter-rouge">M</code><td>Q<td>U<td>O<td>F<td>P<td>S<td>K<td>U<td>K<td>L<td>W<td>F<td>T<td>Z<td><code class="language-plaintext highlighter-rouge">E</code><td>UDRJKOBRGQAOWDZ<tr><td><code class="language-plaintext highlighter-rouge">N</code><td>R<td>V<td>P<td>G<td>Q<td>T<td><code class="language-plaintext highlighter-rouge">L</code><td>V<td>L<td>M<td>X<td><code class="language-plaintext highlighter-rouge">G</code><td>U<td>A<td>F<td>VESKLPCSHRBPXEA<tr><td><code class="language-plaintext highlighter-rouge">O</code><td>S<td>W<td>Q<td>H<td>R<td>U<td>M<td><code class="language-plaintext highlighter-rouge">W</code><td>M<td>N<td>Y<td>H<td>V<td><code class="language-plaintext highlighter-rouge">B</code><td>G<td>WFTLMQDTISCQYFB<tr><td>P<td>T<td>X<td>R<td>I<td>S<td>V<td>N<td>X<td>N<td>O<td>Z<td>I<td>W<td>C<td>H<td>XGUMNREUJTDRZGC<tr><td>Q<td>U<td>Y<td>S<td>J<td>T<td>W<td>O<td>Y<td>O<td>P<td>A<td>J<td>X<td>D<td>I<td>YHVNOSFVKUESAHD<tr><td><code class="language-plaintext highlighter-rouge">R</code><td>V<td>Z<td>T<td><code class="language-plaintext highlighter-rouge">K</code><td>U<td>X<td>P<td>Z<td>P<td><code class="language-plaintext highlighter-rouge">Q</code><td>B<td>K<td>Y<td>E<td>J<td>ZIWOPTGWLVFTBIE<tr><td><code class="language-plaintext highlighter-rouge">S</code><td>W<td>A<td><code class="language-plaintext highlighter-rouge">U</code><td>L<td>V<td><code class="language-plaintext highlighter-rouge">Y</code><td>Q<td>A<td>Q<td>R<td>C<td>L<td>Z<td>F<td>K<td>AJXPQUHXMWGUCJF<tr><td><code class="language-plaintext highlighter-rouge">T</code><td>X<td>B<td>V<td>M<td>W<td>Z<td>R<td>B<td><code class="language-plaintext highlighter-rouge">R</code><td>S<td>D<td>M<td>A<td>G<td>L<td>BKYQRVIYNXHVDKG<tr><td>U<td>Y<td>C<td>W<td>N<td>X<td>A<td>S<td>C<td>S<td>T<td>E<td>N<td>B<td>H<td>M<td>CLZRSWJZOYIWELH<tr><td>V<td>Z<td>D<td>X<td>O<td>Y<td>B<td>T<td>D<td>T<td>U<td>F<td>O<td>C<td>I<td>N<td>DMASTXKAPZJXFMI<tr><td>W<td>A<td>E<td>Y<td>P<td>Z<td>C<td>U<td>E<td>U<td>V<td>G<td>P<td>D<td>J<td>O<td>ENBTUYLBQAKYGNJ<tr><td>X<td>B<td>F<td>Z<td>Q<td>A<td>D<td>V<td>F<td>V<td>W<td>H<td>Q<td>E<td>K<td>P<td>FOCUVZMCRBLZHOK<tr><td>Y<td>C<td>G<td>A<td>R<td>B<td>E<td>W<td>G<td>W<td>X<td>I<td>R<td>F<td>L<td>Q<td>GPDVWANDSCMAIPL<tr><td>Z<td>D<td>H<td>B<td>S<td>C<td>F<td>X<td>H<td>X<td>Y<td>J<td>S<td>G<td>M<td>R<td>HQEWXBOETDNBJQM</table></div><p>And we got our password for the Krypton Level 7!</p><p>Well, it may be not the most orthodox solution, and, maybe, some day, I’ll try to solve it by <a href="https://en.wikipedia.org/wiki/Linear_cryptanalysis">linear cryptanalysis</a>, <a href="https://en.wikipedia.org/wiki/Differential_cryptanalysis">differential cryptanalisys</a> or <a href="https://en.wikipedia.org/wiki/Berlekamp%E2%80%93Massey_algorithm">Berlekamp–Massey algorithm</a>, but it’s a solution :P</p><p><em>Enjoy! ;)</em></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/overthewire/'>overthewire</a>, <a href='/categories/krypton/'>krypton</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/overthewire/" class="post-tag no-text-decoration" >overthewire</a> <a href="/tags/krypton/" class="post-tag no-text-decoration" >krypton</a> <a href="/tags/lfsr/" class="post-tag no-text-decoration" >lfsr</a> <a href="/tags/cryptography/" class="post-tag no-text-decoration" >cryptography</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Overthewire%20krypton%20level%206%20LFSR%20-%20rubenhortas@blog&url=https%3A%2F%2Frubenhortas.github.io%2Fposts%2Foverthewire-krypton-level-6-lfsr%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Overthewire%20krypton%20level%206%20LFSR%20-%20rubenhortas@blog&u=https%3A%2F%2Frubenhortas.github.io%2Fposts%2Foverthewire-krypton-level-6-lfsr%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Frubenhortas.github.io%2Fposts%2Foverthewire-krypton-level-6-lfsr%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/neovim-python-ide/">Configuring Neovim as Python IDE</a><li><a href="/posts/neovim-rust-ide/">Configuring Neovim as Rust IDE</a><li><a href="/posts/neovim-c-standard-ide/">Configuring Neovim as Standard C IDE</a><li><a href="/posts/pycharm-neovim-ruff-consistency/">Unify Python Linting. Syncing Ruff between PyCharm and Neovim</a><li><a href="/posts/check-ntp-servers-windows/">How to check NTP servers from Windows</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hack-the-box/">hack the box</a> <a class="post-tag" href="/tags/challenge/">challenge</a> <a class="post-tag" href="/tags/gnu-linux/">gnu/linux</a> <a class="post-tag" href="/tags/administration/">administration</a> <a class="post-tag" href="/tags/personal/">personal</a> <a class="post-tag" href="/tags/hardening/">hardening</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/programming/">programming</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/ssh/">ssh</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div><script src="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.js"></script></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/overthewire-krytpon-levels-4-5-vigenere-cipher/"><div class="card-body"> <em class="small" data-ts="1667520001" data-df="ll" > Nov 4, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Overthewire krypton levels 4 and 5 Vigenere cipher</h3><div class="text-muted small"><p> In my free time I like to play around in CTF (Capture The Flag or Wargames) platforms, learning a bit and, whith a bit of luck, solving some level or challenge. One of the platforms in which I pla...</p></div></div></a></div><div class="card"> <a href="/posts/xor-known-plaintext-attack/"><div class="card-body"> <em class="small" data-ts="1653004801" data-df="ll" > May 20, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>XOR known-plaintext attack</h3><div class="text-muted small"><p> XOR cipher is a type of additive cipher extremely common as a component in more complex ciphers. XOR cipher can trivially be broken using frequency analysis, and, if the content of any message can...</p></div></div></a></div><div class="card"> <a href="/posts/space-rogue-how-the-hackers-known-as-l0pht-changed-the-world/"><div class="card-body"> <em class="small" data-ts="1677628801" data-df="ll" > Mar 1, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Space Rogue How the hackers known as l0pht changed the world</h3><div class="text-muted small"><p> These days I read the Chris Thomas’ book: Space Rogue How the hackers known as l0pht changed the world. It is a great book and I recommend it. It’s very entertaining and reads very quickly. It wa...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/space-rogue-how-the-hackers-known-as-l0pht-changed-the-world/" class="btn btn-outline-primary" prompt="Older"><p>Space Rogue How the hackers known as l0pht changed the world</p></a> <a href="/posts/maintenance-hdd-gnu-linux/" class="btn btn-outline-primary" prompt="Newer"><p>Maintain HDD in GNU/Linux</p></a></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hack-the-box/">hack the box</a> <a class="post-tag" href="/tags/challenge/">challenge</a> <a class="post-tag" href="/tags/gnu-linux/">gnu/linux</a> <a class="post-tag" href="/tags/administration/">administration</a> <a class="post-tag" href="/tags/personal/">personal</a> <a class="post-tag" href="/tags/hardening/">hardening</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/programming/">programming</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/ssh/">ssh</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2026 <a href="https://github.com/rubenhortas">Rubén Hortas</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/unregister.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-NJBDP43045"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-NJBDP43045'); }); </script>
