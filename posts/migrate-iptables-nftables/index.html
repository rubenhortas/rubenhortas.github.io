<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="Migrate from iptables to nftables. Boost your Linux firewall performance" /><meta property="og:locale" content="en" /><meta name="description" content="Learn the essential steps to migrate your Linux firewall configurations from iptables to nftables. This guide covers syntax, commands, best practices for a smooth transition and offers a good set of essential rules." /><meta property="og:description" content="Learn the essential steps to migrate your Linux firewall configurations from iptables to nftables. This guide covers syntax, commands, best practices for a smooth transition and offers a good set of essential rules." /><link rel="canonical" href="https://rubenhortas.github.io/posts/migrate-iptables-nftables/" /><meta property="og:url" content="https://rubenhortas.github.io/posts/migrate-iptables-nftables/" /><meta property="og:site_name" content="rubenhortas@blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-06-14T02:00:01+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Migrate from iptables to nftables. Boost your Linux firewall performance" /><meta name="twitter:site" content="@rubenhortas" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2026-01-24T15:07:59+01:00","datePublished":"2025-06-14T02:00:01+02:00","description":"Learn the essential steps to migrate your Linux firewall configurations from iptables to nftables. This guide covers syntax, commands, best practices for a smooth transition and offers a good set of essential rules.","headline":"Migrate from iptables to nftables. Boost your Linux firewall performance","mainEntityOfPage":{"@type":"WebPage","@id":"https://rubenhortas.github.io/posts/migrate-iptables-nftables/"},"url":"https://rubenhortas.github.io/posts/migrate-iptables-nftables/"}</script><title>Migrate from iptables to nftables. Boost your Linux firewall performance | rubenhortas@blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="rubenhortas@blog"><meta name="application-name" content="rubenhortas@blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">rubenhortas@blog</a></div><div class="site-subtitle font-italic">Learning everyday</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="javascript:location.href = 'mailto:' + ['rubenhortas','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/rubenhortas" aria-label="linkedin" target="_blank" rel="noopener noreferrer"> <i class="fab fa-linkedin"></i> </a> <a href="https://github.com/rubenhortas" aria-label="github" target="_blank" rel="noopener noreferrer"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/rubenhortas" aria-label="twitter" target="_blank" rel="noopener noreferrer"> <i class="fab fa-twitter"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Migrate from iptables to nftables. Boost your Linux firewall performance</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Migrate from iptables to nftables. Boost your Linux firewall performance</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1749859201" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jun 14, 2025 </em> </span> <span> Updated <em class="" data-ts="1769263679" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jan 24, 2026 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/rubenhortas">Rubén Hortas</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2807 words"> <em>15 min</em> read</span></div></div></div><div class="post-content"><p>Learn the essential steps to migrate your Linux firewall configurations from iptables to nftables. This guide covers syntax, commands, best practices for a smooth transition and offers a good set of essential rules.</p><h2 id="why"><span class="mr-2">Why?</span><a href="#why" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>A while back, due to some changes in my home networks, I decided to harden my systems by implementing firewalls with iptables: <a href="https://rubenhortas.github.io/posts/iptables-essential-rules/">iptables essential rules. A starting point to protect your computer</a>. And, to this day, I’m still very happy with the results. However, as everything changes and evolves, the currently recommended firewall is nftables. So I decided to upgrade myself, my systems, and migrate the firewalls to nftables.</p><h2 id="what-is-nftables"><span class="mr-2">What is nftables?</span><a href="#what-is-nftables" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>nftables is developed by Netfilter, the same organization that currently maintains iptables.</p><p>nftables is a subsystem of the Linux kernel that provides filtering and classification of network packets/datagrams/frames.</p><p>nftables was first publicly presented at Netfilter Workshop 2008 by Patrick McHardy from the Netfilter Core Team. The first preview release of kernel and userspace implementation was given in March 2009.</p><p>On 16 October 2013, Pablo Neira Ayuso submitted a nftables core pull request to the Linux kernel mainline tree. It was merged into the kernel mainline on 19 January 2014, with the release of Linux kernel version 3.13.</p><p>nftables replaces the popular {ip,ip6,arp,eb}tablesreuses the existing Netfilter subsystems, and provides a new in-kernel packet classification framework based on a network-specific Virtual Machine (VM) and a new nft userspace command line tool. This VM is able to execute bytecode to inspect a network packet and make decisions about how to handle it.</p><h2 id="why-ntables-instead-iptables"><span class="mr-2">Why ntables instead iptables?</span><a href="#why-ntables-instead-iptables" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Iptables is aging very well, but nftables is gaining ground. The Netfilter project and the community are focused in replacing iptables with nftables. And, nftables, offers us some advantages over iptables:</p><ul><li>It provides new structures that drastically reduces the number of rules needed to inspect a packet until reaching the final action.<li>Faster packet classification.<li>Simplified dual stack IPv4/IPv6 management (This avoids code duplication and inconsistencies).<li>Nicer and more compact syntax</ul><p>Basically, it avoids duplication of work and inconsistencies, is easier to configure and mantain and is faster. I love working less! ;)</p><h2 id="migrate-from-iptables-to-nftables"><span class="mr-2">Migrate from iptables to nftables</span><a href="#migrate-from-iptables-to-nftables" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>I’m going to explain how to migrate based on some initial rules that you can see in my post <a href="https://rubenhortas.github.io/posts/iptables-essential-rules/">iptables essential rules. A starting point to protect your computer</a>. If you don’t have any initial rules to work from, you will have to manually create your file and you can skip the next sections and jump to <a href="https://rubenhortas.github.io/posts/migrate-iptables-nftables/#test-your-nftables-ruleset">Test your nftables ruleset</a>.</p><h3 id="backup-iptables-rules"><span class="mr-2">Backup iptables rules</span><a href="#backup-iptables-rules" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>iptables-save  <span class="o">&gt;</span> /home/rubenhortas/backups/iptables/iptables/iptables_rules_v4~
<span class="nb">sudo </span>ip6tables-save <span class="o">&gt;</span> /home/rubenhortas/backups/iptables/iptables_rules_v6~
</pre></table></code></div></div><h3 id="install-nftables"><span class="mr-2">Install nftables</span><a href="#install-nftables" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>apt <span class="nb">install </span>nftables
</pre></table></code></div></div><h3 id="translate-iptables-rules-to-nftables-rules"><span class="mr-2">Translate iptables rules to nftables rules</span><a href="#translate-iptables-rules-to-nftables-rules" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>iptables-restore-translate <span class="nt">-f</span> /home/rubenhortas/backups/iptables/iptables/iptables_rules_v4~ <span class="o">&gt;</span> /home/rubenhortas/backups/nftables_rules_v4.nft
<span class="nb">sudo </span>ip6tables-restore-translate <span class="nt">-f</span> /home/rubenhortas/backups/iptables/iptables_rules_v6~ <span class="o">&gt;</span> /home/rubenhortas/backups/nftables_rules_v4.nft
</pre></table></code></div></div><h3 id="review-the-rules-coffee-time-"><span class="mr-2">Review the rules (Coffee time! ☕)</span><a href="#review-the-rules-coffee-time-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>This is usually where I go to make a cup of coffee, because I spend a lot of time reviewing, sorting and commenting the generated rules ;)</p><p>I do this to make a mental map of the rules and needs, and later organize them. Also, some complex iptables extensions might not translate perfectly and may require manual adjustment.</p><p>There is my nftables starting point:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
</pre><td class="rouge-code"><pre><span class="c"># Set Default Policies (DROP everything first)</span>
add table ip filter
add chain ip filter INPUT <span class="o">{</span> <span class="nb">type </span>filter hook input priority 0<span class="p">;</span> policy drop<span class="p">;</span> <span class="o">}</span>
add chain ip filter FORWARD <span class="o">{</span> <span class="nb">type </span>filter hook forward priority 0<span class="p">;</span> policy drop<span class="p">;</span> <span class="o">}</span>
add chain ip filter OUTPUT <span class="o">{</span> <span class="nb">type </span>filter hook output priority 0<span class="p">;</span> policy drop<span class="p">;</span> <span class="o">}</span>

<span class="c"># Allow all traffic on the loopback interface (the internal 127.0.0.1 address. Essential for local processes)</span>
add rule ip filter INPUT iifname <span class="s2">"lo"</span> counter accept
add rule ip filter OUTPUT oifname <span class="s2">"lo"</span> counter accept

<span class="c"># Blacklisting IP adresses</span>
<span class="c"># 168.254.0.0/16 Zeroconf address range. APIPA range.</span>
<span class="c"># 192.0.2.0/24 TEST-NET-1</span>
<span class="c"># 224.0.0.0/4 Multicast</span>
<span class="c"># 240.0.0.0/4 Reserved/Class E</span>
<span class="c"># 255.255.255.255 Broadcast</span>
<span class="c"># 0.0.0.0/8 Unspecified/Current Network</span>
add <span class="nb">set </span>ip filter blacklisted_ips <span class="o">{</span> <span class="nb">type </span>ipv4_addr<span class="p">;</span> flags interval<span class="p">;</span> auto-merge<span class="p">;</span> <span class="o">}</span>
add element ip filter blacklisted_ips <span class="o">{</span> 169.254.0.0/16, 192.0.2.0/24, 224.0.0.0/4, 240.0.0.0/4, 255.255.255.255, 0.0.0.0/8 <span class="o">}</span>
add rule ip filter INPUT ip saddr @blacklisted_ips counter drop

<span class="c"># Spoofing</span>
<span class="c"># Deny incoming traffic that has a source address of an IP address assigned to a local interface.</span>
<span class="c"># Incoming traffic with the source address of your system is going to be spoofed traffic because you know it cannot be generated by the host.# 192.168.1.100 Own ip</span>
add rule ip filter INPUT ip saddr 192.168.1.100 counter drop
add rule ip filter OUTPUT ip saddr <span class="o">!=</span> 192.168.1.100 counter drop  <span class="c"># Deny outgoing traffic that does not have a source address of an interface on the local host.</span>

<span class="c"># Drop packets with invalid state</span>
add rule ip filter INPUT ct state invalid counter drop

<span class="c"># SSH</span>
<span class="c"># Allow incoming SSH connections</span>
<span class="c"># Deny outgoing connections is covered by the OUTPUT policy drop</span>
add rule ip filter INPUT tcp dport 22 ct state new,established counter accept

<span class="c"># Drop Packet fragments</span>
add rule ip filter INPUT ip frag-off &amp; 0x1fff <span class="o">!=</span> 0 counter drop

<span class="c"># Allow Established/Related Connections</span>
add rule ip filter INPUT ct state related,established counter accept
add rule ip filter OUTPUT ct state related,established counter accept

<span class="c"># Bad flags (and another anomalies)</span>
add chain ip filter BAD_FLAGS
add rule ip filter INPUT ip protocol tcp counter jump BAD_FLAGS
add rule ip filter BAD_FLAGS tcp flags fin,syn / fin,syn counter drop
add rule ip filter BAD_FLAGS tcp flags syn,rst / syn,rst counter drop
add rule ip filter BAD_FLAGS tcp flags fin,syn,psh / fin,syn,psh counter drop
add rule ip filter BAD_FLAGS tcp flags fin,syn,rst / fin,syn,rst counter drop
add rule ip filter BAD_FLAGS tcp flags fin,syn,rst,psh / fin,syn,rst,psh counter drop
add rule ip filter BAD_FLAGS tcp flags fin / fin counter drop
add rule ip filter BAD_FLAGS tcp flags 0x0 / fin,syn,rst,psh,ack,urg counter drop
add rule ip filter BAD_FLAGS tcp flags fin,syn,rst,psh,ack,urg / fin,syn,rst,psh,ack,urg counter drop
add rule ip filter BAD_FLAGS tcp flags fin,psh,urg / fin,syn,rst,psh,ack,urg counter drop
add rule ip filter BAD_FLAGS tcp flags fin,syn,rst,ack,urg / fin,syn,rst,psh,ack,urg counter drop

<span class="c"># Port scanners</span>
<span class="c"># Drop packages if the connections are too agressive to avoid port scanning.</span>
add rule ip filter INPUT tcp flags syn / fin,syn,rst,ack ct state new meter port_scanners <span class="o">{</span> ip saddr limit rate over 5/second <span class="o">}</span> counter drop
add rule ip filter INPUT ip protocol udp ct state new meter port_scanners <span class="o">{</span> ip saddr limit rate over 35/second <span class="o">}</span> counter drop

<span class="c"># SYN flood protection</span>
add rule ip filter INPUT tcp flags syn / fin,syn,rst,ack limit rate 100/second burst 200 packets counter accept
add <span class="nb">set </span>ip filter connlimit0 <span class="o">{</span> <span class="nb">type </span>ipv4_addr<span class="p">;</span> flags dynamic<span class="p">;</span> <span class="o">}</span>
add rule ip filter INPUT tcp flags syn / fin,syn,rst,ack add @connlimit0 <span class="o">{</span> ip saddr ct count over 30 <span class="o">}</span> counter reject with tcp reset
add rule ip filter INPUT tcp flags syn / fin,syn,rst,ack counter drop

<span class="c"># ICMP</span>
<span class="c"># All ICMP responses should be barred except responses to outgoing connections.</span>
<span class="c"># Allow outbound echo messages and indbound echo reply messages -&gt; Allows the use of ping from the host.</span>
<span class="c"># Allow time exceeded and destination unreaachable messages inbound -&gt; Allow the use of tools such traceroute.</span>
<span class="c"># Avoids ICMP flood, ICMP smurf, Ping of death, ICMP nuke...</span>
add chain ip filter ICMP_IN
add chain ip filter ICMP_OUT
add rule ip filter INPUT ip protocol icmp counter jump ICMP_IN
add rule ip filter OUTPUT ip protocol icmp counter jump ICMP_OUT
add rule ip filter ICMP_IN icmp <span class="nb">type </span>echo-reply ct state related,established counter accept
add rule ip filter ICMP_IN icmp <span class="nb">type </span>destination-unreachable ct state related,established counter accept
add rule ip filter ICMP_IN icmp <span class="nb">type </span>echo-request ct state new counter drop
add rule ip filter ICMP_IN icmp <span class="nb">type </span>time-exceeded ct state related,established counter accept
add rule ip filter ICMP_OUT icmp <span class="nb">type </span>echo-request ct state new,established counter accept

<span class="c"># Allow NFS</span>
add rule ip filter INPUT tcp dport 2049 ct state new,established counter accept
add rule ip filter OUTPUT tcp sport 2049 ct state established counter accept

<span class="c"># IRC</span>
<span class="c"># add rule ip filter INPUT ip protocol tcp tcp sport 6697 ct state established counter accept</span>
<span class="c"># add rule ip filter OUTPUT ip protocol tcp tcp dport 6697 ct state new,established counter accept</span>

<span class="c"># Allow DNS</span>
add rule ip filter INPUT ip protocol tcp tcp sport <span class="o">{</span> 53, 853 <span class="o">}</span> ct state established counter accept
add rule ip filter INPUT ip protocol udp udp sport <span class="o">{</span> 53, 853 <span class="o">}</span> ct state established counter accept
add rule ip filter OUTPUT ip protocol tcp tcp dport <span class="o">{</span> 53, 853 <span class="o">}</span> ct state new,established counter accept
add rule ip filter OUTPUT ip protocol udp udp dport <span class="o">{</span> 53, 853 <span class="o">}</span> ct state new,established counter accept

<span class="c"># Allow HTTP and HTTPS</span>
add rule ip filter INPUT ip protocol tcp tcp dport <span class="o">{</span> 80, 443 <span class="o">}</span> ct state established counter accept
add rule ip filter OUTPUT ip protocol tcp tcp dport <span class="o">{</span> 80, 443 <span class="o">}</span> ct state new,established counter accept

<span class="c"># Allow NTP</span>
add rule ip filter INPUT udp sport 123 ct state established counter accept
add rule ip filter OUTPUT udp dport 123 ct state new,established counter accept
</pre></table></code></div></div><blockquote class="prompt-info"><p>192.168.1.100 it’s the only IP my machine has and I’m not allowing outgoing ssh connections. Adjust according to your needs.</p></blockquote><p>Now, we can use these rules or we can (manually) create a nftables.conf file.</p><h3 id="create-a-nftablesconf-more-coffee-"><span class="mr-2">Create a nftables.conf (more coffee! ☕☕)</span><a href="#create-a-nftablesconf-more-coffee-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>This is often preferred for a cleaner, more organized setup. You’ll define tables and chains explicitly:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
</pre><td class="rouge-code"><pre><span class="c">#!/usr/sbin/nft -f</span>

<span class="c"># Clear existing rules</span>
flush ruleset

<span class="c"># Interfaces</span>
define LAN_INTERFACE_IPV4 <span class="o">=</span> 192.168.1.100
define LAN_INTERFACE_IPV6 <span class="o">=</span> dead::beef

<span class="c"># Ports</span>
define SSH_PORT <span class="o">=</span> 22
define NFS_PORT <span class="o">=</span> 2049
define HTTP_PORTS <span class="o">=</span> <span class="o">{</span> 80, 443 <span class="o">}</span>
define DNS_PORTS <span class="o">=</span> <span class="o">{</span> 53, 853 <span class="o">}</span>
define NTP_PORT <span class="o">=</span> 123

<span class="c"># Using 'inet' family for rules that apply to both IPv4 and IPv6,</span>
table inet filter <span class="o">{</span>
    <span class="c"># Blacklisted IP addresses</span>
    <span class="nb">set </span>blacklist_ipv4 <span class="o">{</span>
        <span class="nb">type </span>ipv4_addr<span class="p">;</span>
        flags interval<span class="p">;</span>
        auto-merge<span class="p">;</span>
        elements <span class="o">=</span> <span class="o">{</span> 169.254.0.0/16, 192.0.2.0/24, 224.0.0.0/4, 240.0.0.0/4, 255.255.255.255, 0.0.0.0/8 <span class="o">}</span>
    <span class="o">}</span>

    <span class="nb">set </span>blacklist_ipv6 <span class="o">{</span>
        <span class="nb">type </span>ipv6_addr<span class="p">;</span>
        flags interval<span class="p">;</span>
        auto-merge<span class="p">;</span>
        elements <span class="o">=</span> <span class="o">{</span> fe80::/10, 2001:db8::/32, ff00::/8, ::/128 <span class="o">}</span>
    <span class="o">}</span>

    <span class="c"># ICMP handling for incoming traffic (IPv4 &amp; IPv6 consolidated)</span>
    chain ICMP_IN <span class="o">{</span>
        <span class="c"># Allow replies for established/related ICMP sessions</span>
        icmp <span class="nb">type</span> <span class="o">{</span> echo-reply, destination-unreachable, time-exceeded <span class="o">}</span> ct state <span class="o">{</span> related, established <span class="o">}</span> counter accept
        icmpv6 <span class="nb">type</span> <span class="o">{</span> 129, 1, 2, 3, 4 <span class="o">}</span> ct state <span class="o">{</span> related, established <span class="o">}</span> counter accept <span class="c"># echo-reply, dest-unreachable, packet-too-big, time-exceeded, parameter-problem</span>

        <span class="c"># Drop incoming echo-requests (ping) by default</span>
        icmp <span class="nb">type </span>echo-request counter drop
        icmpv6 <span class="nb">type </span>echo-request counter drop
    <span class="o">}</span>

    <span class="c"># ICMP handling for outgoing traffic (IPv4 &amp; IPv6 consolidated)</span>
    chain ICMP_OUT <span class="o">{</span>
        <span class="c"># Allow outgoing echo-requests (ping) and established/related ICMP</span>
        icmp <span class="nb">type </span>echo-request ct state <span class="o">{</span> new, established <span class="o">}</span> counter accept
        icmpv6 <span class="nb">type </span>echo-request ct state <span class="o">{</span> new, established <span class="o">}</span> counter accept
    <span class="o">}</span>

    chain INPUT <span class="o">{</span>
        <span class="nb">type </span>filter hook input priority 0<span class="p">;</span> policy drop<span class="p">;</span> <span class="c"># Default drop policy for incoming</span>

        <span class="c"># Optimize order for performance:</span>
        <span class="c"># High-volume, low-risk traffic first.</span>
        <span class="c"># Specific drops before general accepts.</span>

        <span class="c"># 1. Allow all traffic on the loopback interface (essential for local processes)</span>
        iif <span class="s2">"lo"</span> accept

        <span class="c"># 2. Allow Established/Related Connections (VERY IMPORTANT, handles most ongoing traffic)</span>
        ct state <span class="o">{</span> related, established <span class="o">}</span> counter accept

        <span class="c"># 3. Drop packets with invalid state (e.g., malformed, out-of-sync)</span>
        ct state invalid counter drop

        <span class="c"># 4. Anti-spoofing and blacklisted IPs (fast drops for known bad traffic)</span>
        <span class="c"># IPv4</span>
        iif <span class="o">!=</span> <span class="s2">"lo"</span> ip saddr @blacklist_ipv4 counter drop
        ip saddr <span class="nv">$LAN_INTERFACE_IPV4</span> counter drop <span class="c"># Deny incoming traffic from own IP</span>

        <span class="c">#IPv6</span>
        ip6 saddr @blacklist_ipv6 counter drop
        iif <span class="o">!=</span> <span class="s2">"lo"</span> ip6 saddr <span class="nv">$LAN_INTERFACE_IPV6</span> counter drop

        <span class="c"># 5. Drop fragmented packets that are clearly invalid or cannot be reassembled</span>
        ip frag-off <span class="o">!=</span> 0 ct state invalid counter drop

        <span class="c"># 6. Jump to ICMP chain</span>
        meta l4proto <span class="o">{</span> icmp, icmpv6 <span class="o">}</span> counter jump ICMP_IN

        <span class="c"># 7. Legitimate services</span>
        tcp dport <span class="o">{</span> <span class="nv">$SSH_PORT</span>, <span class="nv">$NFS_PORT</span> <span class="o">}</span> ct state new counter accept
        tcp sport <span class="nv">$DNS_PORTS</span> ct state new counter accept

        udp sport <span class="o">{</span> <span class="nv">$DNS_PORTS</span>, <span class="nv">$NTP_PORT</span> <span class="o">}</span> ct state new counter accept

        <span class="c"># 8. Basic port scanner protection</span>
        ct state new limit rate 10/second burst 20 packets drop
    <span class="o">}</span>

    chain FORWARD <span class="o">{</span>
        <span class="nb">type </span>filter hook forward priority 0<span class="p">;</span> policy drop<span class="p">;</span>
    <span class="o">}</span>

    chain OUTPUT <span class="o">{</span>
        <span class="nb">type </span>filter hook output priority 0<span class="p">;</span> policy drop<span class="p">;</span> <span class="c"># Default drop policy for outgoing</span>

        <span class="c"># 1. Allow all traffic on the loopback interface</span>
        oif <span class="s2">"lo"</span> accept

        <span class="c"># 2. Allow Established/Related Connections</span>
        ct state <span class="o">{</span> related, established <span class="o">}</span> counter accept

        <span class="c"># 3. Anti-spoofing for outgoing traffic</span>
        <span class="c"># Deny outgoing traffic that does not have the source address of the system interface</span>
        oif <span class="o">!=</span> <span class="s2">"lo"</span> ip saddr <span class="o">!=</span> <span class="nv">$LAN_INTERFACE_IPV4</span> counter drop
        oif <span class="o">!=</span> <span class="s2">"lo"</span> ip6 addr <span class="o">!=</span> <span class="nv">$LAN_INTERFACE_IPV6</span> counter drop

        <span class="c"># 4. Legitimate services</span>
        tcp dport <span class="o">{</span> <span class="nv">$DNS_PORTS</span>, <span class="nv">$HTTP_PORTS</span> <span class="o">}</span> ct state new counter accept
        tcp sport <span class="nv">$NFS_PORT</span> ct state new counter accept

        udp dport <span class="o">{</span> <span class="nv">$TRACKER_PORTS</span>, <span class="nv">$DNS_PORTS</span>, <span class="nv">$NTP_PORT</span> <span class="o">}</span> ct state new counter accept
        udp sport <span class="nv">$NFS_PORT</span> ct state new counter accept

        <span class="c"># 5. Jump to ICMP_OUT chain for ICMP/ICMPv6 traffic</span>
        meta l4proto <span class="o">{</span> icmp, icmpv6 <span class="o">}</span> counter jump ICMP_OUT
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><blockquote class="prompt-info"><p>192.168.1.100 it’s the only IP my machine has. Adjust IPs and interfaces according to your needs.</p></blockquote><p>Many of you may have noticed that I have set a static antispoofing configuration. It’s fine for this machine, since it only has a network interace and doesn’t switch networks. If you want a dynamic antisoofing configuration, you can delte the antispoofing blocks (incoming and outcoming) and read: <a href="https://rubenhortas.github.io/posts/nftables-dynamic-antispoofing-networkmanager/">How to prevent IP spoofing with nftables and NetworkManager</a>.</p><h3 id="test-your-nftables-ruleset"><span class="mr-2">Test your nftables ruleset</span><a href="#test-your-nftables-ruleset" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="validate-syntax"><span class="mr-2">Validate syntax</span><a href="#validate-syntax" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><code class="language-plaintext highlighter-rouge">sudo nft -c -f /home/rubenhortas/configs/nftables.conf</code></p><p>If there’s no output, the syntax is correct.</p><h4 id="test-in-coward-mode"><span class="mr-2">Test in coward mode</span><a href="#test-in-coward-mode" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><code class="language-plaintext highlighter-rouge">sudo nft -f /home/rubenhortas/configs/nftables.conf &amp;&amp; sleep 300 &amp;&amp; sudo nft flush ruleset</code></p><p>If anything goes wrong, the nftables rules will be flushed in 5 minutes.</p><p>Verify the rules with:</p><p><code class="language-plaintext highlighter-rouge">sudo nft list ruleset</code></p><p>You have 5 minutes to test your connections. You can repeat these steps as many times as you want/need ;)</p><h3 id="flush-iptables-rules"><span class="mr-2">Flush iptables rules</span><a href="#flush-iptables-rules" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>I flush my iptables and ip6tables at first, to make sure there are no rules in memory:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>iptables <span class="nt">-P</span> INPUT ACCEPT
iptables <span class="nt">-P</span> FORWARD ACCEPT
iptables <span class="nt">-P</span> OUTPUT ACCEPT

iptables <span class="nt">-t</span> nat <span class="nt">-F</span>
iptables <span class="nt">-t</span> mangle <span class="nt">-F</span>
iptables <span class="nt">-F</span>
iptables <span class="nt">-X</span>
</pre></table></code></div></div><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>ip6tables <span class="nt">-P</span> INPUT ACCEPT
ip6tables <span class="nt">-P</span> FORWARD ACCEPT
ip6tables <span class="nt">-P</span> OUTPUT ACCEPT

ip6tables <span class="nt">-t</span> nat <span class="nt">-F</span>
ip6tables <span class="nt">-t</span> mangle <span class="nt">-F</span>
ip6tables <span class="nt">-F</span>
ip6tables <span class="nt">-X</span>
</pre></table></code></div></div><h3 id="disable-and-stop-iptables-services"><span class="mr-2">Disable and stop iptables services</span><a href="#disable-and-stop-iptables-services" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Once we have verified that everything is working correctly, we can disable iptables services:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>systemctl disable <span class="nt">--now</span> iptables
<span class="nb">sudo </span>systemctl disable <span class="nt">--now</span> ip6tables
<span class="nb">sudo </span>systemctl disable <span class="nt">--now</span> netfilter-persistent <span class="c"># If you use iptables-persistent</span>
</pre></table></code></div></div><h3 id="uninstall-iptables-and-netfilter-persistent"><span class="mr-2">Uninstall iptables and netfilter-persistent</span><a href="#uninstall-iptables-and-netfilter-persistent" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><code class="language-plaintext highlighter-rouge">sudo apt purge iptables netfilter-persistent</code></p><h3 id="delete-etciptables"><span class="mr-2">Delete /etc/iptables</span><a href="#delete-etciptables" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><code class="language-plaintext highlighter-rouge">sudo rm -rf /etc/iptables</code></p><h3 id="find-more-iptables-files-or-folders"><span class="mr-2">Find more iptables files (or folders)</span><a href="#find-more-iptables-files-or-folders" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>You can also check if there are more iptables files on the system:</p><p><code class="language-plaintext highlighter-rouge">sudo find / \( -path /proc -o -path ./usr \) -iname *ip?tables* 2&gt;/dev/null</code></p><h3 id="copy-our-nftablesconf-to-etc"><span class="mr-2">Copy our nftables.conf to /etc</span><a href="#copy-our-nftablesconf-to-etc" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>To make the rules persistent, we must save them to a configuration file: <code class="language-plaintext highlighter-rouge">/etc/nftables.conf</code>. The nftables service will start automatically on boot and load the rules from <code class="language-plaintext highlighter-rouge">/etc/nftables.conf</code></p><p><code class="language-plaintext highlighter-rouge">sudo cp /home/rubenhortas/configs/nftables.conf /etc/</code></p><p>And we change the file permissions:</p><p><code class="language-plaintext highlighter-rouge">sudo chown root:root /etc/nftables.conf</code></p><h3 id="enable-and-start-nftables-service"><span class="mr-2">Enable and start nftables service</span><a href="#enable-and-start-nftables-service" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><code class="language-plaintext highlighter-rouge">sudo systemctl enable --now nftables</code></p><h3 id="reboot-and-check-our-nftables-rules"><span class="mr-2">Reboot and check our nftables rules</span><a href="#reboot-and-check-our-nftables-rules" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>After reboot, we can check our nftables rules again to ensure they load correctly and are persisted.</p><p><code class="language-plaintext highlighter-rouge">sudo nft list ruleset</code></p><h2 id="sources"><span class="mr-2">Sources</span><a href="#sources" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><a href="https://netfilter.org/projects/nftables/">netfilter/nftables</a><li><a href="https://wiki.nftables.org">wiki.nftables</a><li><a href="https://en.wikipedia.org/wiki/Nftables">Wikipedia/nftables</a></ul><p>As always, thanks to <a href="https://rodrigorega.es/">Rodrigo Rega</a> for the advice :)</p><p><em>Enjoy! ;)</em></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hardening/'>hardening</a>, <a href='/categories/firewall/'>firewall</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/hardening/" class="post-tag no-text-decoration" >hardening</a> <a href="/tags/firewall/" class="post-tag no-text-decoration" >firewall</a> <a href="/tags/iptables/" class="post-tag no-text-decoration" >iptables</a> <a href="/tags/nftables/" class="post-tag no-text-decoration" >nftables</a> <a href="/tags/network/" class="post-tag no-text-decoration" >network</a> <a href="/tags/sysadmin/" class="post-tag no-text-decoration" >sysadmin</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Migrate%20from%20iptables%20to%20nftables.%20Boost%20your%20Linux%20firewall%20performance%20-%20rubenhortas@blog&url=https%3A%2F%2Frubenhortas.github.io%2Fposts%2Fmigrate-iptables-nftables%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Migrate%20from%20iptables%20to%20nftables.%20Boost%20your%20Linux%20firewall%20performance%20-%20rubenhortas@blog&u=https%3A%2F%2Frubenhortas.github.io%2Fposts%2Fmigrate-iptables-nftables%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Frubenhortas.github.io%2Fposts%2Fmigrate-iptables-nftables%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/neovim-python-ide/">Configuring Neovim as Python IDE</a><li><a href="/posts/neovim-rust-ide/">Configuring Neovim as Rust IDE</a><li><a href="/posts/neovim-c-standard-ide/">Configuring Neovim as Standard C IDE</a><li><a href="/posts/pycharm-neovim-ruff-consistency/">Unify Python Linting. Syncing Ruff between PyCharm and Neovim</a><li><a href="/posts/check-ntp-servers-windows/">How to check NTP servers from Windows</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hack-the-box/">hack the box</a> <a class="post-tag" href="/tags/challenge/">challenge</a> <a class="post-tag" href="/tags/gnu-linux/">gnu/linux</a> <a class="post-tag" href="/tags/administration/">administration</a> <a class="post-tag" href="/tags/personal/">personal</a> <a class="post-tag" href="/tags/hardening/">hardening</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/programming/">programming</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/ssh/">ssh</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div><script src="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.js"></script></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/nftables-dynamic-anti-spoofing-networkmanager/"><div class="card-body"> <em class="small" data-ts="1755302401" data-df="ll" > Aug 16, 2025 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>How to prevent IP spoofing with nftables and NetworkManager</h3><div class="text-muted small"><p> Add dynamic IP anti-spoofing rules to your nftables firewall with NetworkManager. Prevent spoofing of your computer’s network interfaces using dynamic nftables rules. Why? I while ago I wrote my ...</p></div></div></a></div><div class="card"> <a href="/posts/dynamic-firewall-rules-nftables-network-manager/"><div class="card-body"> <em class="small" data-ts="1756512001" data-df="ll" > Aug 30, 2025 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Dynamic firewall rules with nftables and NetworkManager</h3><div class="text-muted small"><p> Dynamically implement IPv4 and IPv6 firewall rules for each network interface with nftables and NetworkManager. If the interface comes online or changes IP, the rules are automatically updated. If ...</p></div></div></a></div><div class="card"> <a href="/posts/iptables-essential-rules/"><div class="card-body"> <em class="small" data-ts="1697932801" data-df="ll" > Oct 22, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>iptables essential rules. A starting point to protect your computer</h3><div class="text-muted small"><p> Learn how to configure a firewall with iptables from scratch. Protect your Linux systems from attacks with this essential, basic configuration guide. This guide covers syntax, commands, best prac...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/upload-package-pypi-github-actions/" class="btn btn-outline-primary" prompt="Older"><p>Upload a package to PyPI automatically with GitHub Actions</p></a> <a href="/posts/nftables-dynamic-anti-spoofing-networkmanager/" class="btn btn-outline-primary" prompt="Newer"><p>How to prevent IP spoofing with nftables and NetworkManager</p></a></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hack-the-box/">hack the box</a> <a class="post-tag" href="/tags/challenge/">challenge</a> <a class="post-tag" href="/tags/gnu-linux/">gnu/linux</a> <a class="post-tag" href="/tags/administration/">administration</a> <a class="post-tag" href="/tags/personal/">personal</a> <a class="post-tag" href="/tags/hardening/">hardening</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/programming/">programming</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/ssh/">ssh</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2026 <a href="https://github.com/rubenhortas">Rubén Hortas</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/unregister.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-NJBDP43045"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-NJBDP43045'); }); </script>
