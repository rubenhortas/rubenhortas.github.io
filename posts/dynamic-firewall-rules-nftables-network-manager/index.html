<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="Dynamic firewall rules with nftables and NetworkManager" /><meta property="og:locale" content="en" /><meta name="description" content="Dynamically implement IPv4 and IPv6 firewall rules for each network interface with nftables and NetworkManager. If the interface comes online or changes IP, the rules are automatically updated. If the interface goes offline, the rules are automatically deleted." /><meta property="og:description" content="Dynamically implement IPv4 and IPv6 firewall rules for each network interface with nftables and NetworkManager. If the interface comes online or changes IP, the rules are automatically updated. If the interface goes offline, the rules are automatically deleted." /><link rel="canonical" href="https://rubenhortas.github.io/posts/dynamic-firewall-rules-nftables-network-manager/" /><meta property="og:url" content="https://rubenhortas.github.io/posts/dynamic-firewall-rules-nftables-network-manager/" /><meta property="og:site_name" content="rubenhortas@blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-08-30T02:00:01+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Dynamic firewall rules with nftables and NetworkManager" /><meta name="twitter:site" content="@rubenhortas" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-09-02T20:00:42+02:00","datePublished":"2025-08-30T02:00:01+02:00","description":"Dynamically implement IPv4 and IPv6 firewall rules for each network interface with nftables and NetworkManager. If the interface comes online or changes IP, the rules are automatically updated. If the interface goes offline, the rules are automatically deleted.","headline":"Dynamic firewall rules with nftables and NetworkManager","mainEntityOfPage":{"@type":"WebPage","@id":"https://rubenhortas.github.io/posts/dynamic-firewall-rules-nftables-network-manager/"},"url":"https://rubenhortas.github.io/posts/dynamic-firewall-rules-nftables-network-manager/"}</script><title>Dynamic firewall rules with nftables and NetworkManager | rubenhortas@blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="rubenhortas@blog"><meta name="application-name" content="rubenhortas@blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">rubenhortas@blog</a></div><div class="site-subtitle font-italic">Learning everyday</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="javascript:location.href = 'mailto:' + ['rubenhortas','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/rubenhortas" aria-label="linkedin" target="_blank" rel="noopener noreferrer"> <i class="fab fa-linkedin"></i> </a> <a href="https://github.com/rubenhortas" aria-label="github" target="_blank" rel="noopener noreferrer"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/rubenhortas" aria-label="twitter" target="_blank" rel="noopener noreferrer"> <i class="fab fa-twitter"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Dynamic firewall rules with nftables and NetworkManager</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Dynamic firewall rules with nftables and NetworkManager</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1756512001" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Aug 30, 2025 </em> </span> <span> Updated <em class="" data-ts="1756836042" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Sep 2, 2025 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/rubenhortas">Rubén Hortas</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1342 words"> <em>7 min</em> read</span></div></div></div><div class="post-content"><p>Dynamically implement IPv4 and IPv6 firewall rules for each network interface with <a href="https://netfilter.org/projects/nftables/">nftables</a> and <a href="https://networkmanager.dev/">NetworkManager</a>. If the interface comes online or changes IP, the rules are automatically updated. If the interface goes offline, the rules are automatically deleted.</p><h2 id="why"><span class="mr-2">Why?</span><a href="#why" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>I while ago I wrote about <a href="https://rubenhortas.github.io/posts/migrate-iptables-nftables/">Migrate from iptables to nftables</a>. More recently I wrote about <a href="https://rubenhortas.github.io/posts/nftables-dynamic-anti-spoofing-networkmanager/">How to prevent IP spoofing with nftables and NetworkManager</a>. Yep, I’m into firewalling lately… :P</p><p>The thing is, as the <a href="https://rubenhortas.github.io/posts/migrate-iptables-nftables/">iptables to nftables migration post</a> is written in a single file (for simplicity and to use a server as an example), and IP spoofing (althoug is implemented dynamically) is only a part of protection, I decided to combine both, and explain how to dynamically manage firewall rules with <a href="https://netfilter.org/projects/nftables/">nftables</a> and <a href="https://networkmanager.dev/">NetworkManager</a>.</p><p>This implementation is geared toward everyday devices (desktops and/or laptops) where network interfaces may be available (or unavailable) and their IP addresses may change. Managing the firewall manually in these environments would be a horrible job, if not impossible.</p><h2 id="the-strategy"><span class="mr-2">The strategy</span><a href="#the-strategy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The strategy, for me, in these scenarios is simple: Keep the <code class="language-plaintext highlighter-rouge">/etc/nftables.conf</code> file as simple as possible and, then, implement rules dynamically for the interfaces with <a href="https://networkmanager.dev/">NetworkManager</a>.</p><h3 id="nftablesconf"><span class="mr-2">nftables.conf</span><a href="#nftablesconf" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>This file should be kept as simple as possible. To achieve this, this file will only contain:</p><ul><li>Deny all rules: We will start from a deny all by default.<li>Rules to allow all traffic for the loopback interface (lo): This is necessary for local applications and services to communicate with each other.<li>ICMP rules: Since this rules will be applied per protocol and (in my case) the same ones will be applied to all interfaces.</ul><blockquote class="prompt-info"><p>If you don’t want all ICMP rules to apply to all interfaces, or you want different ICMP rules to apply to different interfaces, don’t add these rules to the /etc/nftables.conf file and add them to the interface file(s).</p></blockquote><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
</pre><td class="rouge-code"><pre>#!/usr/sbin/nft -f

#/etc/nftables.conf

# Clear existing rules
flush ruleset

# Using 'inet' family for rules that apply to both IPv4 and IPv6
table inet filter {
    # Blacklisted IP addresses
    set blacklist_ipv4_static {
        type ipv4_addr;
        flags interval;
        auto-merge;
        elements = { 169.254.0.0/16, 192.0.2.0/24, 224.0.0.0/4, 240.0.0.0/4, 255.255.255.255, 0.0.0.0/8 };
    }

    set blacklist_ipv4 {
        type ipv4_addr;
        flags dynamic;
    }

    set blacklist_ipv6_static {
        type ipv6_addr;
        flags interval;
        auto-merge;
        elements = { fe80::/10, 2001:db8::/32, ff00::/8, ::/128 };
    }

    set blacklist_ipv6 {
        type ipv6_addr;
        flags dynamic;
    }

    # ICMP handling for incoming traffic (IPv4 &amp; IPv6)
    chain ICMP_IN {
        # Allow replies for established/related ICMP sessions
        icmp type { echo-reply, destination-unreachable, time-exceeded } ct state { related, established } accept
        icmpv6 type { 129, 1, 2, 3, 4 } ct state { related, established } accept # echo-reply, dest-unreachable, packet-too-big, time-exceeded, parameter-problem

        # Drop incoming echo-requests (ping) by default
        icmp type echo-request drop
        icmpv6 type echo-request drop
    }

    # ICMP handling for outgoing traffic (IPv4 &amp; IPv6)
    chain ICMP_OUT {
        # Allow outgoing echo-requests (ping) and established/related ICMP
        icmp type echo-request ct state { new, established } accept
        icmpv6 type echo-request ct state { new, established } accept
    }

    chain INPUT {
        type filter hook input priority 0; policy drop; # Default drop policy for incoming

        # Allow all traffic on the loopback interface (essential for local processes)
        iif "lo" accept
    }

    chain FORWARD {
        type filter hook forward priority 0; policy drop;
    }

    chain OUTPUT {
        type filter hook output priority 0; policy drop; # Default drop policy for outgoing

        # Allow all traffic on the loopback interface
        oif "lo" accept
    }
}
</pre></table></code></div></div><h2 id="the-rules-for-interfaces"><span class="mr-2">The rules for interfaces</span><a href="#the-rules-for-interfaces" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We create the script <code class="language-plaintext highlighter-rouge">10-nftables-hotplug</code> in <code class="language-plaintext highlighter-rouge">/etc/NetworkManager/dispatcher.d/</code> (as root) with the following content (the script is self explainatory):</p><p>At this point, we can create one file for all interfaces or one file for each interface. To maintain a single file, if I needed other rules depending on the interface, I would handle the cases through conditionals in the code of this script. I prefer to keep a single file, but this, as always, will depend on each user’s preferences and needs.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
</pre><td class="rouge-code"><pre>#!/usr/bin/env bash

# /etc/NetworkManager/dispatcher.d/10-nftables-hotplug
# $1 = interface name
# $2 = connection status

delete_rules() {
    interface=$1
    chain=$2
    handles=$(sudo nft -a list chain inet filter $chain | grep "ifname \"$interface\"" | awk '{print $NF}')

    if [ -n "$handles" ]; then
        for handle in $handles; do
            sudo nft delete rule inet filter $chain handle $handle
        done
    fi
}

# Delete old rules
delete_rules "$1" INPUT
delete_rules "$1" OUTPUT

if [[ "$1" != lo &amp;&amp; ("$2" = "up" || "$2" = "dhcp4-change" || "$2" = "dhcp6-change") ]]; then
    # Add rules to the INPUT chain

    # 1. Anti-spofing
    ipv4=$(ip addr show $1 | awk '$1=="inet"{gsub("/.*","",$2); print $2; next}')

    if [ -n "$ipv4" ]; then
        nft add rule inet filter INPUT iifname "$1" ip saddr "$ipv4" drop
    fi

    ipv6=$(ip addr show $1 | awk '$1=="inet6"{gsub("/.*","",$2); print $2; next}')

    if [ -n "$ipv6" ]; then
        nft add rule inet filter INPUT iifname "$1" ip6 saddr "$ipv6" drop
    fi

    # 2. Accept established and related traffic
    nft add rule inet filter INPUT iifname "$1" ct state { established, related } accept

    # 3. Drop traffic from known blacklisted ips
    nft add rule inet filter INPUT iifname "$1" ip saddr @blacklist_ipv4 drop
    nft add rule inet filter INPUT iifname "$1" ip6 saddr @blacklist_ipv6 drop

    # 4. Drop invalid traffic
    nft add rule inet filter INPUT iifname "$1" ct state invalid drop

    # 5. Drop invalid fragmented packets
    nft add rule inet filter INPUT iifname "$1" ip frag-off != 0 tcp dport 22 ct state new accept

    # 6. Jump to an ICMP chain
    nft add rule inet filter INPUT iifname "$1" meta l4proto { icmp, icmpv6 } jump ICMP_IN

    # 7. Limit and drop new connections to prevent floods and scans
    nft add rule inet filter INPUT iifname "$1" tcp limit rate 5/second burst 15 packets counter add @blacklist_ipv4 { ip saddr } drop
    nft add rule inet filter INPUT iifname "$1" tcp limit rate 5/second burst 15 packets counter add @blacklist_ipv6 { ip6 saddr } drop
    nft add rule inet filter INPUT iifname "$1" udp limit rate 5/second burst 15 packets counter add @blacklist_ipv4 { ip saddr } drop
    nft add rule inet filter INPUT iifname "$1" udp limit rate 5/second burst 15 packets counter add @blacklist_ipv6 { ip6 saddr } drop

    # 8. Accept all incoming traffic
    nft add rule inet filter INPUT iifname "$1" ct state new accept

    # Add rules to the OUTPUT chain

    # 1. Jump to an ICMP chain
    nft add rule inet filter OUTPUT oifname "$1" meta l4proto { icmp, icmpv6 } jump ICMP_OUT

    # 2. Accept all outgoing traffic
    nft add rule inet filter OUTPUT oifname "$1" accept
fi
</pre></table></code></div></div><blockquote class="prompt-info"><p>Scripts placed in /etc/NetworkManager/dispatcher.d/ should be named with a number (between 00 and 99) followed by a descriptive number. The naming convention it’s XX-name. <a href="https://networkmanager.dev/">NetworkManager</a> executes these scripts in numerical order from lowest to highest.</p></blockquote><blockquote class="prompt-warning"><p>Note that, in this example, all incoming and outgoing traffic is allowed. You should only allow traffic for your trusted services.</p></blockquote><p>With this script, every time an interface connects or changes IP, its old rules will be deleted, and new ones will be added, taking into account the new IP. If an interface is disconnected, its associated rules will be deleted.</p><p><em>Enjoy! ;)</em></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hardening/'>hardening</a>, <a href='/categories/firewall/'>firewall</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/hardening/" class="post-tag no-text-decoration" >hardening</a> <a href="/tags/firewall/" class="post-tag no-text-decoration" >firewall</a> <a href="/tags/iptables/" class="post-tag no-text-decoration" >iptables</a> <a href="/tags/nftables/" class="post-tag no-text-decoration" >nftables</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Dynamic%20firewall%20rules%20with%20nftables%20and%20NetworkManager%20-%20rubenhortas@blog&url=https%3A%2F%2Frubenhortas.github.io%2Fposts%2Fdynamic-firewall-rules-nftables-network-manager%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Dynamic%20firewall%20rules%20with%20nftables%20and%20NetworkManager%20-%20rubenhortas@blog&u=https%3A%2F%2Frubenhortas.github.io%2Fposts%2Fdynamic-firewall-rules-nftables-network-manager%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Frubenhortas.github.io%2Fposts%2Fdynamic-firewall-rules-nftables-network-manager%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/python-web-server/">Python web server</a><li><a href="/posts/python-charset-detection/">Python charset detection</a><li><a href="/posts/keep-ssh-session-alive/">Keep alive ssh sessions</a><li><a href="/posts/find-files-containing-specific-text-gnu-linux/">Find files containing specific text on GNU/Linux</a><li><a href="/posts/upload-package-pypi/">Upload a package to PyPI</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hack-the-box/">hack the box</a> <a class="post-tag" href="/tags/challenge/">challenge</a> <a class="post-tag" href="/tags/gnu-linux/">gnu/linux</a> <a class="post-tag" href="/tags/administration/">administration</a> <a class="post-tag" href="/tags/personal/">personal</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/hardening/">hardening</a> <a class="post-tag" href="/tags/programming/">programming</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/misc/">misc</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div><script src="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.js"></script></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/migrate-iptables-nftables/"><div class="card-body"> <em class="small" data-ts="1749859201" data-df="ll" > Jun 14, 2025 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Migrate from iptables to nftables. Boost your Linux firewall performance</h3><div class="text-muted small"><p> Learn the essential steps to migrate your Linux firewall configurations from iptables to nftables. This guide covers syntax, commands, best practices for a smooth transition and offers a good set o...</p></div></div></a></div><div class="card"> <a href="/posts/nftables-dynamic-anti-spoofing-networkmanager/"><div class="card-body"> <em class="small" data-ts="1755302401" data-df="ll" > Aug 16, 2025 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>How to prevent IP spoofing with nftables and NetworkManager</h3><div class="text-muted small"><p> Add dynamic IP anti-spoofing rules to your nftables firewall with NetworkManager. Prevent spoofing of your computer’s network interfaces using dynamic nftables rules. Why? I while ago I wrote my ...</p></div></div></a></div><div class="card"> <a href="/posts/iptables-essential-rules/"><div class="card-body"> <em class="small" data-ts="1697932801" data-df="ll" > Oct 22, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>iptables essential rules. A starting point to protect your computer</h3><div class="text-muted small"><p> Learn how to configure a firewall with iptables from scratch. Protect your Linux systems from attacks with this essential, basic configuration guide. This guide covers syntax, commands, best prac...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/nftables-dynamic-anti-spoofing-networkmanager/" class="btn btn-outline-primary" prompt="Older"><p>How to prevent IP spoofing with nftables and NetworkManager</p></a><div class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></div></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hack-the-box/">hack the box</a> <a class="post-tag" href="/tags/challenge/">challenge</a> <a class="post-tag" href="/tags/gnu-linux/">gnu/linux</a> <a class="post-tag" href="/tags/administration/">administration</a> <a class="post-tag" href="/tags/personal/">personal</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/hardening/">hardening</a> <a class="post-tag" href="/tags/programming/">programming</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/misc/">misc</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/rubenhortas">Rubén Hortas</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/unregister.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-NJBDP43045"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-NJBDP43045'); }); </script>
